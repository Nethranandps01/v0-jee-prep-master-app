(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7124:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>s_});var r=s(5155),a=s(2115);let l=(window._env_?.NEXT_PUBLIC_API_BASE_URL??"https://jpm-backend.onrender.com/api/v1"??("localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname?"https://jpm-backend.onrender.com/api/v1":"http://localhost:8000/api/v1")).replace(/\/+$/,"");class n extends Error{constructor(e,t){super(e),this.name="ApiError",this.detail=e,this.status=t}}let d=null,i=null;function o(e,t={}){let s=new URL(`${l}${e}`);return Object.entries(t).forEach(([e,t])=>{void 0!==t&&s.searchParams.set(e,String(t))}),s.toString()}async function c(e){let t=`Request failed (${e.status})`;try{let s=await e.json();"string"==typeof s?.detail?t=s.detail:Array.isArray(s?.detail)&&(t=s.detail.map(e=>"string"==typeof e?e:"object"==typeof e&&null!==e&&"msg"in e&&"string"==typeof e.msg?e.msg:null).filter(e=>!!e).join(", "))}catch{}return new n(t,e.status)}async function x(e,t={}){let s="u">typeof FormData&&void 0!==t.body&&t.body instanceof FormData,r=await fetch(o(e,t.query),{method:t.method??"GET",headers:{...void 0!==t.body&&!s?{"Content-Type":"application/json"}:{},...t.token?{Authorization:`Bearer ${t.token}`}:{},...t.headers??{}},body:void 0===t.body?void 0:s?t.body:JSON.stringify(t.body),cache:"no-store",keepalive:t.keepalive});if(401===r.status&&t.token&&d&&!t.skipRefresh){let s=d.getRefreshToken();if(s)try{let r=await ex(s);return d.onTokenRefresh(r),x(e,{...t,token:r.access_token,skipRefresh:!0})}catch{d.onAuthFailure?.()}else d.onAuthFailure?.()}if(!r.ok)throw await c(r);if(204!==r.status&&(r.headers.get("content-type")??"").includes("application/json"))return await r.json()}async function m(e){return x("/auth/login",{method:"POST",body:e})}async function u(e){return x("/auth/register",{method:"POST",body:e})}async function f(e){return x("/auth/refresh",{method:"POST",body:{refresh_token:e}})}async function h(e){return x("/auth/me",{token:e})}async function p(e){return x("/admin/dashboard",{token:e})}async function g(e,t={}){return x("/admin/users",{token:e,query:{role:t.role,status:t.status,search:t.search,page:t.page??1,limit:t.limit??20}})}async function b(e,t){return x("/admin/users",{method:"POST",token:e,body:t})}async function j(e,t,s){return x(`/admin/users/${t}/status`,{method:"PATCH",token:e,body:{status:s}})}async function N(e,t={}){return x("/admin/content-items",{token:e,query:{status:t.status,subject:t.subject,page:t.page??1,limit:t.limit??20}})}async function v(e,t,s){return x(`/admin/content-items/${t}/status`,{method:"PATCH",token:e,body:{status:s}})}async function y(e){return x("/admin/reports/analytics",{token:e})}async function w(e){return x("/admin/reports/billing",{token:e})}async function k(e,t){let s=await em(o("/admin/reports/export",{section:t,format:"csv"}),e,{method:"GET",cache:"no-store"});if(!s.ok)throw await c(s);let r=s.headers.get("content-disposition")??"",a=/filename="?([^"]+)"?/i.exec(r);return{filename:a?.[1]??`${t}-report.csv`,blob:await s.blob()}}async function A(e){return x("/teacher/home-summary",{token:e})}async function S(e){return x("/teacher/papers",{token:e})}async function C(e,t){return x("/teacher/papers",{method:"POST",token:e,body:t})}async function $(e,t){return x(`/teacher/papers/${t}`,{token:e})}async function _(e,t,s){return x(`/teacher/papers/${t}/assign`,{method:"POST",token:e,body:{class_ids:s}})}async function P(e){return x("/teacher/classes",{token:e})}async function T(e,t){return x("/teacher/classes",{method:"POST",token:e,body:t})}async function E(e,t){return x(`/teacher/classes/${t}/assignable-students`,{token:e})}async function D(e,t,s){return x(`/teacher/classes/${t}/students`,{method:"PUT",token:e,body:{student_ids:s}})}async function M(e,t={}){return x("/teacher/lesson-plans",{token:e,query:{year:t.year}})}async function q(e,t){return x("/teacher/lesson-plans",{method:"POST",token:e,body:t})}async function L(e,t,s){return x(`/teacher/lesson-plans/${t}`,{method:"PATCH",token:e,body:s})}async function F(e,t){return x(`/teacher/lesson-plans/${t}`,{method:"DELETE",token:e})}async function R(e,t){return x(`/teacher/students/${t}/attempts`,{token:e})}async function z(e){return x("/teacher/library-items",{token:e})}async function U(e,t){let s=new FormData;return s.append("title",t.title),s.append("subject",t.subject),s.append("type",t.type),s.append("chapters",String(t.chapters)),s.append("year",t.year),s.append("publish_now",String(t.publishNow??!1)),s.append("file",t.file),x("/teacher/library-items/upload",{method:"POST",token:e,body:s})}async function I(e){return x("/student/home-summary",{token:e})}async function O(e,t={}){return x("/student/tests",{token:e,query:{status:t.status,subject:t.subject}})}async function B(e,t){return x(`/student/tests/${t}/start`,{method:"POST",token:e})}async function G(e,t,s,r){return x(`/student/attempts/${t}/answers`,{method:"POST",token:e,body:{answers:s,time_spent:r}})}async function H(e,t,s={},r={}){return x(`/student/attempts/${t}/submit`,{method:"POST",token:e,body:{...s.violation_reason?{violation_reason:s.violation_reason}:{},...s.time_spent?{time_spent:s.time_spent}:{}},keepalive:r.keepalive})}async function Q(e,t){return x(`/student/results/${t}`,{token:e})}async function J(e){return x("/student/progress",{token:e})}async function W(e,t={}){return x("/student/library-items",{token:e,query:{subject:t.subject}})}async function Y(e){return x("/student/library-downloads",{token:e})}async function V(e,t){let s=await em(o(`/student/library-items/${t}/download`),e,{method:"GET",cache:"no-store"});if(!s.ok)throw await c(s);let r=s.headers.get("content-disposition")??"",a=/filename="?([^"]+)"?/i.exec(r);return{filename:a?.[1]??`${t}.txt`,blob:await s.blob()}}async function K(e,t){return x("/student/feedback",{method:"POST",token:e,body:t})}async function X(e){return x("/notifications",{token:e})}async function Z(e,t,s=!0){return x(`/notifications/${t}/read`,{method:"PATCH",token:e,body:{read:s}})}async function ee(e){return x("/notifications/read-all",{method:"POST",token:e})}async function et(e,t){return x("/admin/settings/jee-exam-date",{method:"POST",token:e,body:{jee_exam_date:t}})}async function es(e){return x("/student/planner/plan",{token:e})}async function er(e,t){return x(`/student/planner/tasks/${t}/quiz`,{method:"POST",token:e})}async function ea(e,t,s){return x(`/student/planner/quiz/${t}/submit`,{method:"POST",token:e,body:{answers:s}})}async function el(e,t,s){return x(`/student/planner/tasks/${t}/subtopics/toggle`,{method:"POST",token:e,query:{subtopic:s}})}async function en(e,t){let s=await fetch(`${l}/student/chat/sessions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({title:t})});if(!s.ok)throw new n("Failed to create chat session",s.status);return s.json()}async function ed(e,t=20){let s=await fetch(`${l}/student/chat/sessions?limit=${t}`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new n("Failed to list chat sessions",s.status);return s.json()}async function ei(e,t){let s=await fetch(`${l}/student/chat/sessions/${t}/messages`,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new n("Failed to get chat messages",s.status);return s.json()}async function eo(e,t){let s=await fetch(`${l}/student/chat/sessions/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new n("Failed to delete chat session",s.status)}async function ec(e,t,s,r,a){let d=a?`${l}${t}?session_id=${a}`:`${l}${t}`,i=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)});if(!i.ok)throw new n((await i.json().catch(()=>({}))).detail||"Stream request failed",i.status);if(!i.body)throw Error("ReadableStream not supported in this browser.");let o=i.body.getReader(),c=new TextDecoder;try{for(;;){let{done:e,value:t}=await o.read();if(e)break;let s=c.decode(t,{stream:!0});r(s)}}finally{o.releaseLock()}}async function ex(e){return i||(i=f(e).finally(()=>{i=null}))}async function em(e,t,s){let r=new Headers(s.headers);r.set("Authorization",`Bearer ${t}`);let a=await fetch(e,{...s,headers:r});if(401!==a.status||!d)return a;let l=d.getRefreshToken();if(!l)return d.onAuthFailure?.(),a;try{let t=await ex(l);d.onTokenRefresh(t);let r=new Headers(s.headers);return r.set("Authorization",`Bearer ${t.access_token}`),fetch(e,{...s,headers:r})}catch{return d.onAuthFailure?.(),a}}let eu=(0,a.createContext)(void 0),ef="jpm_auth_v1";function eh({children:e}){let[t,s]=(0,a.useState)("splash"),[l,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(null),[f,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(""),[b,j]=(0,a.useState)(!1),[N,v]=(0,a.useState)(null),[y,w]=(0,a.useState)(null),[k,A]=(0,a.useState)(null),[S,C]=(0,a.useState)(null),[$,_]=(0,a.useState)(null),[P,T]=(0,a.useState)(null),[E,D]=(0,a.useState)(null),[M,q]=(0,a.useState)(null),[L,F]=(0,a.useState)(null),[R,z]=(0,a.useState)(null),[U,I]=(0,a.useState)(null),[O,B]=(0,a.useState)(null),[G,H]=(0,a.useState)(null),[Q,J]=(0,a.useState)(null),W=(0,a.useCallback)(()=>{window.localStorage.removeItem(ef),u(null),h(null),n(null),o(null),x(null),g(""),T(null),D(null),q(null),w(null),v(null),A(null),C(null),_(null),j(!1)},[]),Y=(0,a.useCallback)(e=>{s(e)},[]);return(0,a.useEffect)(()=>{let e=window.localStorage.getItem(ef);if(e)try{let t=JSON.parse(e);if(!t.authToken||!t.refreshToken||!t.role)return void window.localStorage.removeItem(ef);n(t.role),o(t.userId??null),x(t.userEmail??null),g(t.userName??""),u(t.authToken),h(t.refreshToken),T(t.teacherSubject??null),q(t.studentYear??null),s("admin"===t.role?"admin-dashboard":"teacher"===t.role?"teacher-home":"student-home")}catch{window.localStorage.removeItem(ef)}},[]),(0,a.useEffect)(()=>{m&&f&&l?window.localStorage.setItem(ef,JSON.stringify({role:l,userId:i,userEmail:c,userName:p,authToken:m,refreshToken:f,teacherSubject:P,studentYear:M})):window.localStorage.removeItem(ef)},[m,f,l,i,c,p,P,M]),(0,a.useEffect)(()=>(d={getRefreshToken:()=>f,onTokenRefresh:e=>{u(e.access_token),h(e.refresh_token)},onAuthFailure:()=>{W(),s("auth")}},()=>{d=null}),[f,W]),(0,r.jsx)(eu.Provider,{value:{screen:t,setScreen:s,role:l,setRole:n,userId:i,setUserId:o,userEmail:c,setUserEmail:x,authToken:m,setAuthToken:u,refreshToken:f,setRefreshToken:h,clearAuth:W,userName:p,setUserName:g,showAIChat:b,setShowAIChat:j,activeTestId:N,setActiveTestId:v,activeAttemptId:y,setActiveAttemptId:w,completedTestId:k,setCompletedTestId:A,attemptQuestions:S,setAttemptQuestions:C,attemptAnswers:$,setAttemptAnswers:_,teacherSubject:P,setTeacherSubject:T,selectedStudentId:E,setSelectedStudentId:D,studentYear:M,setStudentYear:q,navigate:Y,studentHomeData:L,setStudentHomeData:F,studentProgressData:R,setStudentProgressData:z,teacherHomeData:U,setTeacherHomeData:I,adminDashboardData:O,setAdminDashboardData:B,studentLibraryData:G,setStudentLibraryData:H,studentLibraryDownloads:Q,setStudentLibraryDownloads:J},children:e})}function ep(){let e=(0,a.useContext)(eu);if(!e)throw Error("useApp must be used within an AppProvider");return e}var eg=s(3961);function eb(){let{navigate:e}=ep();return(0,a.useEffect)(()=>{let t=setTimeout(()=>{e("onboarding")},2500);return()=>clearTimeout(t)},[e]),(0,r.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background",children:[(0,r.jsxs)("div",{className:"animate-scale-in flex flex-col items-center gap-6",children:[(0,r.jsxs)("div",{className:"relative flex h-24 w-24 items-center justify-center rounded-3xl bg-primary animate-pulse-glow",children:[(0,r.jsx)(eg.A,{className:"h-12 w-12 text-primary-foreground"}),(0,r.jsx)("div",{className:"absolute -right-1 -top-1 h-4 w-4 rounded-full bg-accent"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold tracking-tight text-foreground",children:"JPM"}),(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"AI-Powered JEE Mastery"})]}),(0,r.jsxs)("div",{className:"mt-8 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-primary",style:{animationDelay:"0ms"}}),(0,r.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-primary",style:{animationDelay:"150ms"}}),(0,r.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-primary",style:{animationDelay:"300ms"}})]})]}),(0,r.jsx)("p",{className:"absolute bottom-8 text-xs text-muted-foreground",children:"Preparing your learning experience..."})]})}var ej=s(4850),eN=s(8460),ev=s(9722),ey=s(622);function ew(...e){return(0,ey.QP)((0,ev.$)(e))}let ek=(0,eN.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),eA=a.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...l},n)=>{let d=a?ej.DX:"button";return(0,r.jsx)(d,{className:ew(ek({variant:t,size:s,className:e})),ref:n,...l})});eA.displayName="Button";var eS=s(7810),eC=s(9123),e$=s(5559),e_=s(1628),eP=s(1362);let eT=[{icon:eg.A,title:"Ace JEE with AI",description:"Leverage cutting-edge AI to create personalized study plans, generate smart practice papers, and get instant doubt resolution.",color:"bg-primary"},{icon:eS.A,title:"Smart Papers & Feedback",description:"AI-generated question papers tailored to your weak areas, with detailed solutions and performance analytics after every test.",color:"bg-accent"},{icon:eC.A,title:"Track Your Progress",description:"Real-time rank tracking, topic-wise mastery rings, and improvement suggestions to keep you ahead of the competition.",color:"bg-warning"},{icon:e$.A,title:"Choose Your Role",description:"Whether you're a student preparing for JEE or a teacher creating test papers, JEE Prep Master has you covered.",color:"bg-primary"}];function eE(){let{navigate:e}=ep(),[t,s]=(0,a.useState)(0),l=eT[t],n=l.icon;return(0,r.jsxs)("div",{className:"flex min-h-screen flex-col bg-background",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 pt-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eg.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"JPM"})]}),(0,r.jsx)(eA,{variant:"ghost",size:"sm",onClick:()=>{e("auth")},className:"text-muted-foreground",children:"Skip"})]}),(0,r.jsx)("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col items-center gap-8 text-center",children:[(0,r.jsx)("div",{className:`flex h-28 w-28 items-center justify-center rounded-[2rem] ${l.color}`,children:(0,r.jsx)(n,{className:"h-14 w-14 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-foreground text-balance",children:l.title}),(0,r.jsx)("p",{className:"max-w-sm text-sm leading-relaxed text-muted-foreground text-pretty",children:l.description})]})]},t)}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-6 px-8 pb-12",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:eT.map((e,a)=>(0,r.jsx)("button",{onClick:()=>s(a),className:`h-2 rounded-full transition-all duration-300 ${a===t?"w-8 bg-primary":"w-2 bg-muted-foreground/30"}`,"aria-label":`Go to slide ${a+1}`},a))}),(0,r.jsx)(eA,{onClick:()=>{t<eT.length-1?s(t+1):e("auth")},className:"w-full max-w-sm gap-2 rounded-2xl bg-primary py-6 text-base font-semibold text-primary-foreground",size:"lg",children:t===eT.length-1?(0,r.jsxs)(r.Fragment,{children:["Get Started",(0,r.jsx)(e_.A,{className:"h-5 w-5"})]}):(0,r.jsxs)(r.Fragment,{children:["Next",(0,r.jsx)(eP.A,{className:"h-5 w-5"})]})})]})]})}let eD=a.forwardRef(({className:e,type:t,...s},a)=>(0,r.jsx)("input",{type:t,className:ew("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...s}));eD.displayName="Input";var eM=s(1023);let eq=(0,eN.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),eL=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(eM.b,{ref:s,className:ew(eq(),e),...t}));eL.displayName=eM.b.displayName;var eF=s(723),eR=s(439);let ez={admin:"Admin",teacher:"Teacher",student:"Student"},eU={admin:[{label:"Principal",email:"admin@jpee.com",password:"admin12345"}],teacher:[{label:"Dr. Sharma",email:"sharma@example.com",password:"password123"},{label:"Dr. Gupta",email:"gupta@example.com",password:"password123"},{label:"Prof. Verma",email:"verma@example.com",password:"password123"}],student:[{label:"Rahul Kumar",email:"rahul@example.com",password:"password123"},{label:"Priya Singh",email:"priya@example.com",password:"password123"},{label:"Amit Verma",email:"amit@example.com",password:"password123"}]};function eI(){let{navigate:e,setRole:t,setUserId:s,setUserEmail:l,setUserName:d,setTeacherSubject:i,setStudentYear:o,setAuthToken:c,setRefreshToken:x,clearAuth:f}=ep(),[p,g]=(0,a.useState)("role"),[b,j]=(0,a.useState)("signin"),[N,v]=(0,a.useState)(null),[y,w]=(0,a.useState)(""),[k,A]=(0,a.useState)(""),[S,C]=(0,a.useState)(""),[$,_]=(0,a.useState)("Physics"),[P,T]=(0,a.useState)("12th"),[E,D]=(0,a.useState)(null),[M,q]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!N)return;if("signup"===b){w(""),A(""),C("");return}let e=eU[N][0];A(e.email),C(e.password)},[b,N]);let L=e=>{v(e),j("signin"),w(""),_("Physics"),T("12th"),D(null),g("login")},F=async()=>{if(!N||M)return;let r=k.trim().toLowerCase();if(!r||!S.trim())return void D("Email and password are required.");if("signup"===b){if("admin"===N)return void D("Admin signup is disabled. Sign in with an existing admin account.");if(!y.trim())return void D("Full name is required.");if(S.trim().length<8)return void D("Password must be at least 8 characters.")}q(!0),D(null);try{let a="signin"===b?await m({email:r,password:S}):await u({name:y.trim(),email:r,password:S,role:"teacher"===N?"teacher":"student",subject:"teacher"===N?$:void 0,year:"student"===N?P:void 0}),n=await h(a.access_token);if(n.role!==N)return void D(`This account is "${n.role}", not "${N}".`);f(),t(n.role),s(n.id),l(n.email),d(n.name),i(n.subject??null),o(n.year??null),c(a.access_token),x(a.refresh_token),e("admin"===n.role?"admin-dashboard":"teacher"===n.role?"teacher-home":"student-home")}catch(e){e instanceof n?D(e.detail):D("Login failed. Please try again.")}finally{q(!1)}};return(0,r.jsxs)("div",{className:"flex min-h-screen flex-col bg-background",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 px-6 pt-12",children:["role"!==p&&(0,r.jsx)("button",{onClick:()=>{"login"===p&&(g("role"),j("signin"),w(""),D(null),C(""))},className:"flex h-8 w-8 items-center justify-center rounded-lg text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-4 w-4"})}),(0,r.jsx)(eg.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"JEE Prep Master"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col px-6 pt-8",children:["role"===p&&(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground text-balance",children:"Welcome Back"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose your role to continue"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"I am a..."}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:()=>L("student"),className:"flex flex-1 flex-col items-center gap-3 rounded-2xl border-2 border-border bg-card p-5 transition-all hover:border-primary/50",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-muted",children:(0,r.jsx)(e$.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Student"})]}),(0,r.jsxs)("button",{onClick:()=>L("teacher"),className:"flex flex-1 flex-col items-center gap-3 rounded-2xl border-2 border-border bg-card p-5 transition-all hover:border-accent/50",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-muted",children:(0,r.jsx)(eS.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Teacher"})]}),(0,r.jsxs)("button",{onClick:()=>L("admin"),className:"flex flex-1 flex-col items-center gap-3 rounded-2xl border-2 border-border bg-card p-5 transition-all hover:border-warning/50",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-muted",children:(0,r.jsx)(eR.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,r.jsx)("span",{className:"text-xs font-semibold text-foreground",children:"Admin"})]})]})]})]}),"login"===p&&N&&(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-foreground text-balance",children:"signup"===b?"Create Account":"Sign In"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:ez[N]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{j("signin"),D(null)},className:`flex-1 rounded-xl py-2 text-xs font-semibold transition-colors ${"signin"===b?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:"Sign In"}),(0,r.jsx)("button",{type:"button",onClick:()=>{"admin"!==N&&(j("signup"),D(null))},disabled:"admin"===N,className:`flex-1 rounded-xl py-2 text-xs font-semibold transition-colors disabled:opacity-50 ${"signup"===b?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:"Sign Up"})]}),"signin"===b&&(0,r.jsxs)("div",{className:"rounded-xl border border-border bg-card p-3",children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,r.jsxs)("span",{className:"text-xs font-semibold text-foreground",children:["Demo ",ez[N]," Accounts"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Tap to autofill"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:eU[N].map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{A(e.email),C(e.password),D(null)},className:"flex items-center justify-between rounded-lg border border-border bg-background px-3 py-2 text-left transition-colors hover:bg-muted/40",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.label}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:e.email})]}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-primary",children:"Autofill"})]},e.email))})]}),"signup"===b&&(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{htmlFor:"name",className:"text-sm font-medium text-foreground",children:"Full Name"}),(0,r.jsx)(eD,{id:"name",type:"text",value:y,onChange:e=>w(e.target.value),className:"rounded-xl border-border bg-card py-5 text-foreground placeholder:text-muted-foreground",placeholder:"Your full name"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{htmlFor:"email",className:"text-sm font-medium text-foreground",children:"Email"}),(0,r.jsx)(eD,{id:"email",type:"email",value:k,onChange:e=>A(e.target.value),className:"rounded-xl border-border bg-card py-5 text-foreground placeholder:text-muted-foreground",placeholder:"you@example.com"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{htmlFor:"password",className:"text-sm font-medium text-foreground",children:"Password"}),(0,r.jsx)(eD,{id:"password",type:"password",value:S,onChange:e=>C(e.target.value),className:"rounded-xl border-border bg-card py-5 text-foreground placeholder:text-muted-foreground",placeholder:"Enter your password"})]}),"signup"===b&&"teacher"===N&&(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{htmlFor:"subject",className:"text-sm font-medium text-foreground",children:"Subject"}),(0,r.jsxs)("select",{id:"subject",value:$,onChange:e=>_(e.target.value),className:"w-full rounded-xl border border-border bg-card px-3 py-3 text-sm text-foreground",children:[(0,r.jsx)("option",{value:"Physics",children:"Physics"}),(0,r.jsx)("option",{value:"Chemistry",children:"Chemistry"}),(0,r.jsx)("option",{value:"Mathematics",children:"Mathematics"})]})]}),"signup"===b&&"student"===N&&(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{htmlFor:"year",className:"text-sm font-medium text-foreground",children:"Class Year"}),(0,r.jsxs)("select",{id:"year",value:P,onChange:e=>T(e.target.value),className:"w-full rounded-xl border border-border bg-card px-3 py-3 text-sm text-foreground",children:[(0,r.jsx)("option",{value:"11th",children:"11th"}),(0,r.jsx)("option",{value:"12th",children:"12th"})]})]}),E&&(0,r.jsx)("p",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:E}),(0,r.jsxs)(eA,{onClick:F,disabled:M,className:"mt-2 w-full gap-2 rounded-2xl bg-primary py-6 text-base font-semibold text-primary-foreground",size:"lg",children:[M?"signup"===b?"Creating Account...":"Signing In...":"signup"===b?"Create Account":"Sign In",(0,r.jsx)(e_.A,{className:"h-5 w-5"})]})]})]})]}),(0,r.jsx)("p",{className:"px-6 pb-8 text-center text-xs text-muted-foreground",children:"By continuing, you agree to our Terms of Service and Privacy Policy"})]})}var eO=s(4023),eB=s(5221),eG=s(1058),eH=s(7149),eQ=s(2508),eJ=s(4071),eW=s(4980),eY=s(6901);let eV=["Physics","Chemistry","Mathematics"];function eK(){let{userName:e,navigate:t,setActiveTestId:s,setActiveAttemptId:l,setCompletedTestId:d,studentYear:i,authToken:o,studentHomeData:c,setStudentHomeData:x}=ep(),m=i||"12th",[u,f]=(0,a.useState)(c?.tests||[]),[h,p]=(0,a.useState)(c?.summary||null),[g,b]=(0,a.useState)(c?.progress||null),[j,N]=(0,a.useState)(c?.studyPlan||null),[v,y]=(0,a.useState)(!c),[w,k]=(0,a.useState)(null),[A,S]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!o){k("Student login is required."),y(!1);return}y(!0),k(null);try{let[t,s,r,a]=await Promise.all([I(o),J(o),O(o),es(o).catch(()=>null)]);e||(p(t),b(s),f(r),N(a),x({summary:t,progress:s,tests:r,studyPlan:a}))}catch(t){e||(t instanceof n?k(t.detail):k("Failed to load dashboard data."))}finally{e||y(!1)}})(),()=>{e=!0}},[o,A]);let C=(0,a.useMemo)(()=>u.filter(e=>"assigned"===e.status),[u]),$=(0,a.useMemo)(()=>u.filter(e=>"completed"===e.status&&e.attempt_id),[u]),_=(0,a.useMemo)(()=>eV.map(e=>{let t=$.filter(t=>t.subject===e&&"number"==typeof t.score).sort((e,t)=>(e.created_at?new Date(e.created_at).getTime():0)-(t.created_at?new Date(t.created_at).getTime():0));return{subject:e,latest:t[t.length-1]?.score??null}}),[$]),P={Physics:eO.A,Chemistry:eB.A,Mathematics:eG.A},T=h?.streak??0,E=h?.avg_score??0,D=g?.overall_rank??0,M=(0,a.useMemo)(()=>j&&j.tasks?j.tasks.find(e=>"completed"!==e.status)||j.tasks[0]:null,[j]),q=(0,a.useMemo)(()=>j&&j.tasks&&0!==j.tasks.length?Math.round(j.tasks.filter(e=>"completed"===e.status).length/j.tasks.length*100):35,[j]),L=(0,a.useMemo)(()=>{if(!j?.target_exam_date)return null;let e=new Date(j.target_exam_date),t=new Date;return Math.max(0,Math.ceil((e.getTime()-t.getTime())/864e5))},[j]);return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-4",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Good morning,"}),(0,r.jsxs)("span",{className:"rounded-full bg-primary/10 px-2.5 py-0.5 text-[10px] font-semibold text-primary",children:[m," Class"]})]}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-foreground text-balance",children:e||"Student"})]}),w&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:w}),(0,r.jsx)("button",{onClick:()=>S(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex gap-3",style:{animationDelay:"100ms"},children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-warning/15",children:(0,r.jsx)(eH.A,{className:"h-5 w-5 text-warning"})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:v?"--":T}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Day Streak"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(eQ.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:v?"--":`${E.toFixed(1)}%`}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Avg Score"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent/15",children:(0,r.jsx)(eJ.A,{className:"h-5 w-5 text-accent"})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:v?"--":`#${D}`}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Rank"})]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"150ms"},children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Subject Scores"}),(0,r.jsx)("div",{className:"flex gap-3",children:_.map(e=>{let t=P[e.subject]||eS.A;return(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-2 rounded-2xl border border-border bg-card p-3",children:[(0,r.jsx)("div",{className:`flex h-9 w-9 items-center justify-center rounded-lg ${"Physics"===e.subject?"bg-primary/15":"Chemistry"===e.subject?"bg-accent/15":"bg-warning/15"}`,children:(0,r.jsx)(t,{className:`h-4 w-4 ${"Physics"===e.subject?"text-primary":"Chemistry"===e.subject?"text-accent":"text-warning"}`})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:null===e.latest?"--":`${e.latest}%`}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground text-center",children:e.subject})]},e.subject)})})]}),(0,r.jsxs)("button",{onClick:()=>t("student-study-plan"),className:"animate-fade-in flex flex-col gap-4 rounded-2xl border border-accent/20 bg-accent/5 p-5 text-left transition-colors hover:bg-accent/10",style:{animationDelay:"150ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent",children:(0,r.jsx)(eW.A,{className:"h-5 w-5 text-accent-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:"My Study Plan"}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider font-semibold",children:"Active Timeline"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end",children:[(0,r.jsxs)("span",{className:"text-xs font-bold text-accent",children:["JEE ",j?.target_exam_date?new Date(j.target_exam_date).getFullYear():"2026"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:null!==L?`${L} Days Left`:"Target Date"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-[11px]",children:[(0,r.jsxs)("span",{className:"text-muted-foreground font-medium",children:["Daily Goal: ",j?.availability_hours??4," Hours"]}),(0,r.jsxs)("span",{className:"text-accent font-bold",children:[q,"% Complete"]})]}),(0,r.jsx)("div",{className:"h-1.5 w-full overflow-hidden rounded-full bg-accent/20",children:(0,r.jsx)("div",{className:"h-full rounded-full bg-accent",style:{width:`${q}%`}})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-xl bg-background/50 p-2.5",children:[(0,r.jsx)(eY.A,{className:"h-3.5 w-3.5 text-accent"}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-foreground line-clamp-1",children:M?`Next: ${M.title} - ${M.topic}`:"Plan your first study session"}),(0,r.jsx)(eP.A,{className:"ml-auto h-3 w-3 text-muted-foreground"})]})]}),(0,r.jsxs)("button",{onClick:()=>t("ai-chat"),className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-primary/20 bg-primary/5 p-4 text-left transition-colors hover:bg-primary/10",style:{animationDelay:"200ms"},children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary",children:(0,r.jsx)(eY.A,{className:"h-6 w-6 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"AI Study Assistant"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Ask doubts, get explanations, practice problems"})]}),(0,r.jsx)(eP.A,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"300ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Upcoming Tests"}),(0,r.jsxs)("button",{onClick:()=>t("student-tests"),className:"flex items-center gap-1 text-xs font-medium text-primary",children:["View All ",(0,r.jsx)(e_.A,{className:"h-3 w-3"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[v&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading tests..."})}),!v&&0===C.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["No upcoming tests for ",m," class"]})}),!v&&C.slice(0,3).map(e=>(0,r.jsxs)("button",{onClick:()=>{s(e.id),l(null),d(null),t("student-test-active")},className:"flex items-center gap-4 rounded-2xl border border-border bg-card p-4 text-left transition-colors hover:bg-muted/50",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10",children:(0,r.jsx)(eS.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.subject}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pt-1",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1 text-[11px] text-muted-foreground",children:[(0,r.jsx)(eW.A,{className:"h-3 w-3"}),e.duration," min"]}),(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[e.questions," Qs"]}),(0,r.jsx)("span",{className:`rounded-full px-2 py-0.5 text-[10px] font-medium ${"Hard"===e.difficulty?"bg-destructive/15 text-destructive":"Medium"===e.difficulty?"bg-warning/15 text-warning":"bg-accent/15 text-accent"}`,children:e.difficulty})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:function(e){if(!e)return"--";let t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}(e.created_at)}),(0,r.jsx)(e_.A,{className:"h-4 w-4 text-muted-foreground"})]})]},e.id))]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"400ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Recent Results"}),(0,r.jsxs)("button",{onClick:()=>t("student-progress"),className:"flex items-center gap-1 text-xs font-medium text-primary",children:["View All ",(0,r.jsx)(e_.A,{className:"h-3 w-3"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[!v&&0===$.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No results yet"})}),!v&&$.slice(0,3).map(e=>(0,r.jsxs)("button",{onClick:()=>{e.attempt_id&&(d(e.attempt_id),t("student-results"))},className:"flex items-center gap-4 rounded-2xl border border-border bg-card p-4 text-left transition-colors hover:bg-muted/50",children:[(0,r.jsxs)("div",{className:"relative flex h-12 w-12 items-center justify-center",children:[(0,r.jsxs)("svg",{className:"h-12 w-12 -rotate-90",viewBox:"0 0 48 48",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"hsl(var(--muted))",strokeWidth:"4"}),(0,r.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"4",strokeLinecap:"round",strokeDasharray:`${(e.score??0)/100*125.6} 125.6`})]}),(0,r.jsxs)("span",{className:"absolute text-xs font-bold text-foreground",children:[e.score??0,"%"]})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.subject})]}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-muted-foreground"})]},e.id))]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"500ms"},children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)(eA,{variant:"outline",onClick:()=>t("student-library"),className:"flex h-auto flex-col items-center gap-2 rounded-2xl border-border bg-card p-4 text-foreground hover:bg-muted/50",children:[(0,r.jsx)(eS.A,{className:"h-6 w-6 text-primary"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Study Material"})]}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>t("ai-chat"),className:"flex h-auto flex-col items-center gap-2 rounded-2xl border-border bg-card p-4 text-foreground hover:bg-muted/50",children:[(0,r.jsx)(eY.A,{className:"h-6 w-6 text-accent"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"Ask AI"})]}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>t("student-progress"),className:"flex h-auto flex-col items-center gap-2 rounded-2xl border-border bg-card p-4 text-foreground hover:bg-muted/50",children:[(0,r.jsx)(eJ.A,{className:"h-6 w-6 text-warning"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"My Progress"})]}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>t("student-tests"),className:"flex h-auto flex-col items-center gap-2 rounded-2xl border-border bg-card p-4 text-foreground hover:bg-muted/50",children:[(0,r.jsx)(eQ.A,{className:"h-6 w-6 text-primary"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"All Tests"})]})]})]})]})}var eX=s(2622),eZ=s(2651);let e0=["All","Assigned","Completed"],e1=["All","Physics","Chemistry","Mathematics"];function e2(){let{navigate:e,setActiveTestId:t,setActiveAttemptId:s,setCompletedTestId:l,studentYear:d,authToken:i}=ep(),[o,c]=(0,a.useState)("All"),[x,m]=(0,a.useState)("All"),[u,f]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),[g,b]=(0,a.useState)(null),[j,N]=(0,a.useState)(0);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!i){b("Student login is required."),p(!1);return}p(!0),b(null);try{let t="All"===o?void 0:o.toLowerCase(),s=await O(i,{status:t,subject:"All"===x?void 0:x});e||f(s)}catch(t){e||(t instanceof n?b(t.detail):b("Failed to load tests."),f([]))}finally{e||p(!1)}})(),()=>{e=!0}},[o,x,i,j]),(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"My Tests"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[d||"12th"," Class - ",h?"Loading...":`${u.length} tests`]})]}),g&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:g}),(0,r.jsx)("button",{onClick:()=>N(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eX.A,{className:"h-4 w-4 text-muted-foreground"}),e0.map(e=>(0,r.jsx)("button",{onClick:()=>c(e),className:`rounded-full px-4 py-1.5 text-xs font-medium transition-colors ${o===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))]}),(0,r.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:e1.map(e=>(0,r.jsx)("button",{onClick:()=>m(e),className:`whitespace-nowrap rounded-full px-3 py-1 text-[11px] font-medium transition-colors ${x===e?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[h&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading tests..."})}),!h&&0===u.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No tests found"})}),!h&&u.map((a,n)=>(0,r.jsxs)("button",{onClick:()=>{"assigned"===a.status?(t(a.id),s(null),l(null),e("student-test-active")):a.attempt_id&&(l(a.attempt_id),e("student-results"))},className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-border bg-card p-4 text-left transition-colors hover:bg-muted/50",style:{animationDelay:`${80*n}ms`},children:[(0,r.jsx)("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl ${"completed"===a.status?"bg-accent/15":"bg-primary/10"}`,children:"completed"===a.status?(0,r.jsx)(eZ.A,{className:"h-6 w-6 text-accent"}):(0,r.jsx)(eS.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:a.title}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:a.subject}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pt-1",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1 text-[11px] text-muted-foreground",children:[(0,r.jsx)(eW.A,{className:"h-3 w-3"}),a.duration," min"]}),(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[a.questions," Qs"]}),(0,r.jsx)("span",{className:`rounded-full px-2 py-0.5 text-[10px] font-medium ${"Hard"===a.difficulty?"bg-destructive/15 text-destructive":"Medium"===a.difficulty?"bg-warning/15 text-warning":"bg-accent/15 text-accent"}`,children:a.difficulty})]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[null!==a.score&&void 0!==a.score&&(0,r.jsxs)("span",{className:"text-lg font-bold text-primary",children:[a.score,"%"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:function(e){if(!e)return"--";let t=new Date(e);return Number.isNaN(t.getTime())?"--":t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}(a.created_at)}),(0,r.jsx)(e_.A,{className:"h-4 w-4 text-muted-foreground"})]})]},a.id))]})]})}var e5=s(1585),e3=s(1641),e4=s(9320);function e6(){let e,t,{navigate:s,activeTestId:l,authToken:d,setCompletedTestId:i,setActiveAttemptId:o,setAttemptQuestions:c,setAttemptAnswers:x}=ep(),[m,u]=(0,a.useState)(0),[f,h]=(0,a.useState)([]),[p,g]=(0,a.useState)([]),[b,j]=(0,a.useState)([]),[N,v]=(0,a.useState)(0),[y,w]=(0,a.useState)({}),[k,A]=(0,a.useState)(null),[S,C]=(0,a.useState)(!0),[$,_]=(0,a.useState)(null),[P,T]=(0,a.useState)(null),[E,D]=(0,a.useState)(!1),[M,q]=(0,a.useState)(!1),L=(0,a.useRef)(!1),F=(0,a.useCallback)(e=>{let t={};return f.forEach((s,r)=>{t[s.id]=e[r]??null}),t},[f]);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!d){_("Student login is required."),C(!1);return}if(!l){_("No test selected. Please choose a test first."),C(!1);return}C(!0),_(null),T(null),i(null);try{let t=await B(d,l);if(e)return;let s=t.questions||[];h(s),c(s);let r=t.answers||{},a=s.map(e=>{let t=r[e.id];return"number"==typeof t&&t>=0?t:null});g(a),x(a),j(Array(s.length).fill(!1));let n=60*Math.max(t.duration,1),i=new Date(t.started_at).getTime(),m=Number.isNaN(i)?0:Math.max(0,Math.floor((Date.now()-i)/1e3)),f=Math.max(n-m,0);v(f),A(t.attempt_id),o(t.attempt_id),u(0)}catch(t){e||(t instanceof n?_(t.detail):_("Failed to start test."),h([]),g([]),j([]))}finally{e||C(!1)}})(),()=>{e=!0}},[l,d,o,x,c,i]),(0,a.useEffect)(()=>{if(S||N<=0)return;let e=setInterval(()=>{if(v(t=>t<=1?(clearInterval(e),0):t-1),f[m]){let e=f[m].id;w(t=>({...t,[e]:(t[e]||0)+1}))}},1e3);return()=>{clearInterval(e)}},[S,N,m,f]),(0,a.useEffect)(()=>{if(!d||!k||S||0===f.length)return;let e=setTimeout(async()=>{try{await G(d,k,F(p),y)}catch{}},400);return()=>{clearTimeout(e)}},[p,k,d,F,S,f.length]);let R=(0,a.useCallback)(async e=>{if(!d||!k||M)return;let t=(e||"").trim(),r=!!t;if(!r||!L.current){r&&(L.current=!0,D(!1)),q(!0),T(null);try{if(r)try{await G(d,k,F(p),y)}catch{}else await G(d,k,F(p),y);let e=await H(d,k,{...r?{violation_reason:t}:{},time_spent:y},{keepalive:r});i(e.attempt_id),x(p),s("student-results")}catch(e){e instanceof n?T(e.detail):T("Failed to submit test."),q(!1),r&&(L.current=!1)}}},[p,k,d,F,s,x,i,M]);(0,a.useEffect)(()=>{S||N>0||M||R()},[S,R,M,N]),(0,a.useEffect)(()=>{if(!d||!k||S||0===f.length||M)return;let e=()=>{R("Student switched tab or app during active test")},t=()=>{"hidden"===document.visibilityState&&e()},s=e=>{e.preventDefault(),R("Opened context menu during active test (possible capture attempt)")},r=e=>{let t=e.key.toLowerCase();("printscreen"===t||(e.ctrlKey||e.metaKey)&&e.shiftKey&&("s"===t||"4"===t||"5"===t))&&(e.preventDefault(),R("Screenshot shortcut detected during active test"))};return document.addEventListener("visibilitychange",t),document.addEventListener("contextmenu",s),document.addEventListener("keydown",r),window.addEventListener("blur",e),window.addEventListener("pagehide",e),()=>{document.removeEventListener("visibilitychange",t),document.removeEventListener("contextmenu",s),document.removeEventListener("keydown",r),window.removeEventListener("blur",e),window.removeEventListener("pagehide",e)}},[k,d,S,f.length,R,M]);let z=(0,a.useMemo)(()=>p.filter(e=>null!==e).length,[p]),U=(0,a.useMemo)(()=>b.filter(Boolean).length,[b]),I=f[m];return S?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card px-6 py-5 text-sm text-muted-foreground",children:"Starting test..."})}):$?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex w-full max-w-sm flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-5",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:$}),(0,r.jsx)(eA,{onClick:()=>s("student-tests"),className:"rounded-xl bg-primary text-primary-foreground",children:"Back to Tests"})]})}):I?E?(0,r.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex w-full max-w-sm flex-col items-center gap-6 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-warning/15",children:(0,r.jsx)(e5.A,{className:"h-8 w-8 text-warning"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Submit Test?"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["You have answered ",z," of ",f.length," questions.",U>0&&` ${U} flagged for review.`]}),P&&(0,r.jsx)("span",{className:"text-xs text-destructive",children:P})]}),(0,r.jsxs)("div",{className:"flex w-full gap-3",children:[(0,r.jsx)(eA,{variant:"outline",onClick:()=>D(!1),className:"flex-1 rounded-xl bg-transparent py-5 text-foreground",disabled:M,children:"Review"}),(0,r.jsx)(eA,{onClick:()=>void R(),className:"flex-1 rounded-xl bg-primary py-5 text-primary-foreground",disabled:M,children:M?"Submitting...":"Submit"})]})]})}):(0,r.jsxs)("div",{className:"flex min-h-screen flex-col bg-background pb-[env(safe-area-inset-bottom)]",children:[(0,r.jsxs)("header",{className:"sticky top-0 z-40 flex items-center justify-between border-b border-border bg-card/95 px-4 pb-3 pt-[calc(12px+env(safe-area-inset-top))] backdrop-blur-xl",children:[(0,r.jsx)("button",{onClick:()=>D(!0),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Exit test",children:(0,r.jsx)(e3.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-full bg-muted px-3 py-1.5",children:[(0,r.jsx)(eW.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:`text-sm font-mono font-semibold ${N<300?"text-destructive":"text-foreground"}`,children:(e=Math.floor(N/3600),t=Math.floor(N%3600/60),`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}:${(N%60).toString().padStart(2,"0")}`)})]}),(0,r.jsx)("button",{onClick:()=>{j(e=>{let t=[...e];return t[m]=!t[m],t})},className:`flex h-10 w-10 items-center justify-center rounded-xl transition-colors ${b[m]?"bg-warning/15 text-warning":"text-muted-foreground hover:bg-muted"}`,"aria-label":b[m]?"Remove flag":"Flag question",children:(0,r.jsx)(e4.A,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"flex gap-1.5 overflow-x-auto px-4 py-3",children:f.map((e,t)=>(0,r.jsx)("button",{onClick:()=>u(t),className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-lg text-xs font-medium transition-all ${t===m?"bg-primary text-primary-foreground":null!==p[t]?"bg-accent/15 text-accent":b[t]?"bg-warning/15 text-warning":"bg-muted text-muted-foreground"}`,"aria-label":`Question ${t+1}`,children:t+1},t))}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-6 px-4 pb-32 pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"rounded-full bg-muted px-3 py-1 text-xs font-medium text-muted-foreground",children:I.subject}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Q",m+1," of ",f.length]})]}),(0,r.jsx)("p",{className:"text-base font-medium leading-relaxed text-foreground",children:I.text}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:I.options.map((e,t)=>(0,r.jsxs)("button",{onClick:()=>{let e;(e=[...p])[m]=e[m]===t?null:t,g(e),x(e)},className:`flex items-center gap-3 rounded-2xl border-2 p-4 text-left transition-all ${p[m]===t?"border-primary bg-primary/10":"border-border bg-card hover:border-primary/30"}`,children:[(0,r.jsx)("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full border-2 text-sm font-semibold transition-all ${p[m]===t?"border-primary bg-primary text-primary-foreground":"border-muted-foreground/30 text-muted-foreground"}`,children:String.fromCharCode(65+t)}),(0,r.jsx)("span",{className:`text-sm ${p[m]===t?"font-medium text-foreground":"text-foreground"}`,children:e}),p[m]===t&&(0,r.jsx)(eZ.A,{className:"ml-auto h-5 w-5 text-primary"})]},t))})]}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 border-t border-border bg-card/95 px-4 py-4 backdrop-blur-xl",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(eA,{variant:"outline",onClick:()=>u(Math.max(0,m-1)),disabled:0===m,className:"flex-1 gap-1 rounded-xl bg-transparent py-5 text-foreground",children:[(0,r.jsx)(e3.A,{className:"h-4 w-4"}),"Previous"]}),m===f.length-1?(0,r.jsx)(eA,{onClick:()=>D(!0),className:"flex-1 rounded-xl bg-accent py-5 text-accent-foreground",disabled:M,children:"Submit Test"}):(0,r.jsxs)(eA,{onClick:()=>u(Math.min(f.length-1,m+1)),className:"flex-1 gap-1 rounded-xl bg-primary py-5 text-primary-foreground",children:["Next",(0,r.jsx)(eP.A,{className:"h-4 w-4"})]})]})})]}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex w-full max-w-sm flex-col gap-3 rounded-2xl border border-border bg-card p-5",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No questions found for this test."}),(0,r.jsx)(eA,{onClick:()=>s("student-tests"),className:"rounded-xl bg-primary text-primary-foreground",children:"Back to Tests"})]})})}var e8=s(3810),e9=s(4928),e7=s(2791),te=s(5031),tt=s(1885),ts=s(9921),tr=s(6088);let ta={Physics:"hsl(217, 91%, 60%)",Chemistry:"hsl(160, 84%, 39%)",Mathematics:"hsl(25, 95%, 53%)",General:"hsl(var(--primary))"};function tl(e,t){return null===e||e<0||e>=t.length?"Not Attempted":`${String.fromCharCode(65+e)}. ${t[e]}`}function tn(){let{navigate:e,completedTestId:t,authToken:s}=ep(),[l,d]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[c,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)("all"),[f,h]=(0,a.useState)("All"),[p,g]=(0,a.useState)(!0),[b,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!s){j("Student login is required."),g(!1);return}if(!t){j("No result selected. Open a completed test to view result."),g(!1);return}g(!0),j(null);try{let r=await Q(s,t);e||d(r)}catch(t){e||(t instanceof n?j(t.detail):j("Failed to load result."),d(null))}finally{e||g(!1)}})(),()=>{e=!0}},[s,t]);let N=(0,a.useMemo)(()=>{if(!l)return[];if(0===l.questions.length)return[{subject:l.subject||"General",score:l.correct_answers,total:l.total_questions,color:ta[l.subject]||ta.General}];let e=new Map;return l.questions.forEach(t=>{let s=t.subject||"General",r=e.get(s)||{total:0,correct:0};r.total+=1,t.is_correct&&(r.correct+=1),e.set(s,r)}),Array.from(e.entries()).map(([e,t])=>({subject:e,score:t.correct,total:t.total,color:ta[e]||ta.General}))},[l]),v=(0,a.useMemo)(()=>l&&0!==l.questions.length?["All",...Array.from(new Set(l.questions.map(e=>e.subject||"General")))]:["All"],[l]),y=(0,a.useMemo)(()=>l?l.questions.filter(e=>("All"===f||e.subject===f)&&("correct"!==m||!!e.is_correct)&&("wrong"!==m||!e.is_correct&&null!==e.selected_answer)&&("skipped"!==m||null===e.selected_answer)):[],[m,l,f]),w=async()=>{if(!l)return;let e=`I scored ${l.score}% in ${l.subject}. Correct: ${l.correct_answers}/${l.total_questions}.`;try{if("u">typeof navigator&&navigator.share)return void await navigator.share({title:"JEE Test Result",text:e});"u">typeof navigator&&navigator.clipboard&&await navigator.clipboard.writeText(e)}catch{}};return p?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card px-6 py-5 text-sm text-muted-foreground",children:"Loading result..."})}):b||!l?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex w-full max-w-sm flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-5",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:b||"Result not available."}),(0,r.jsx)(eA,{onClick:()=>e("student-tests"),className:"rounded-xl bg-primary text-primary-foreground",children:"Back to Tests"})]})}):(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>e("student-home"),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Test Results"}),(0,r.jsx)("button",{onClick:()=>{w()},className:"ml-auto flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Share results",children:(0,r.jsx)(e8.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsxs)("div",{className:"relative flex h-28 w-28 items-center justify-center",children:[(0,r.jsxs)("svg",{className:"h-28 w-28 -rotate-90",viewBox:"0 0 112 112",children:[(0,r.jsx)("circle",{cx:"56",cy:"56",r:"48",fill:"none",stroke:"hsl(var(--muted))",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"56",cy:"56",r:"48",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${l.score/100*301.6} 301.6`})]}),(0,r.jsx)("div",{className:"absolute flex flex-col items-center",children:(0,r.jsxs)("span",{className:"text-3xl font-bold text-foreground",children:[l.score,"%"]})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(e9.A,{className:"h-5 w-5 text-warning"}),(0,r.jsx)("span",{className:"text-base font-semibold text-foreground",children:"Performance Summary"})]}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Subject: ",l.subject,"  Attempted: ",l.answered,"/",l.total_questions]})]}),(0,r.jsxs)("div",{className:"flex w-full gap-3 pt-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-xl bg-accent/10 p-3",children:[(0,r.jsx)(eZ.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:l.correct_answers}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Correct"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-xl bg-destructive/10 p-3",children:[(0,r.jsx)(e7.A,{className:"h-5 w-5 text-destructive"}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:l.incorrect_answers}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Incorrect"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-xl bg-muted p-3",children:[(0,r.jsx)(te.A,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:l.unattempted}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Skipped"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Subject-wise Performance"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:N.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-muted-foreground",children:[e.score,"/",e.total]})]}),(0,r.jsx)("div",{className:"h-2.5 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:"h-full rounded-full transition-all",style:{width:`${0===e.total?0:e.score/e.total*100}%`,backgroundColor:e.color}})})]},e.subject))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-accent"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Attempt Breakdown"})]}),(0,r.jsx)("div",{className:"flex gap-3",children:[{name:"Correct",value:l.correct_answers,color:"hsl(var(--accent))"},{name:"Wrong",value:l.incorrect_answers,color:"hsl(var(--destructive))"},{name:"Skipped",value:l.unattempted,color:"hsl(var(--muted-foreground))"}].map(e=>(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-2 rounded-xl bg-muted/50 p-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full",style:{backgroundColor:`${e.color}20`},children:(0,r.jsx)("span",{className:"text-sm font-bold",style:{color:e.color},children:e.value})}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-muted-foreground",children:e.name})]},e.name))})]}),(0,r.jsxs)("button",{onClick:()=>x(!c),className:"flex items-center justify-between rounded-2xl border border-border bg-card p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(tt.A,{className:"h-4 w-4 text-warning"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Detailed Question Analysis"})]}),c?(0,r.jsx)(ts.A,{className:"h-5 w-5 text-muted-foreground"}):(0,r.jsx)(tr.A,{className:"h-5 w-5 text-muted-foreground"})]}),c&&(0,r.jsx)("div",{className:"animate-fade-in flex flex-col gap-4",children:0===l.questions.length?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-4 text-sm text-muted-foreground",children:"Detailed per-question analysis is not available for this attempt."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eX.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("div",{className:"flex gap-2 overflow-x-auto",children:["all","correct","wrong","skipped"].map(e=>(0,r.jsx)("button",{onClick:()=>u(e),className:`whitespace-nowrap rounded-full px-3 py-1 text-[11px] font-medium capitalize transition-colors ${m===e?"correct"===e?"bg-accent text-accent-foreground":"wrong"===e?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:e},e))})]}),(0,r.jsx)("div",{className:"flex gap-2 overflow-x-auto",children:v.map(e=>(0,r.jsx)("button",{onClick:()=>h(e),className:`whitespace-nowrap rounded-full px-3 py-1 text-[11px] font-medium transition-colors ${f===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:e},e))})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:y.map((e,t)=>(0,r.jsx)(td,{question:e,index:t,expanded:i===e.question_id,onToggle:()=>{var t;o(i===(t=e.question_id)?null:t)}},e.question_id))})]})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(eA,{variant:"outline",onClick:()=>e("student-feedback"),className:"flex-1 rounded-2xl bg-transparent py-5 text-foreground",children:"Give Feedback"}),(0,r.jsx)(eA,{onClick:()=>e("student-home"),className:"flex-1 rounded-2xl bg-primary py-5 text-primary-foreground",children:"Back to Home"})]})]})}function td({question:e,index:t,expanded:s,onToggle:a}){return(0,r.jsxs)("div",{className:"overflow-hidden rounded-2xl border border-border bg-card",children:[(0,r.jsxs)("button",{onClick:a,className:"flex w-full items-center gap-3 p-4 text-left",children:[(0,r.jsx)("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-lg ${e.is_correct?"bg-accent/15":null===e.selected_answer?"bg-muted":"bg-destructive/15"}`,children:e.is_correct?(0,r.jsx)(eZ.A,{className:"h-4 w-4 text-accent"}):null===e.selected_answer?(0,r.jsx)(te.A,{className:"h-4 w-4 text-muted-foreground"}):(0,r.jsx)(e7.A,{className:"h-4 w-4 text-destructive"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsxs)("span",{className:"line-clamp-2 text-xs font-medium text-foreground",children:["Q",t+1,". ",e.question_text]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[9px] font-medium text-muted-foreground",children:e.subject})})]}),s?(0,r.jsx)(ts.A,{className:"h-4 w-4 shrink-0 text-muted-foreground"}):(0,r.jsx)(tr.A,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),s&&(0,r.jsx)("div",{className:"animate-fade-in border-t border-border p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-[11px] font-medium text-muted-foreground",children:"Your Answer:"}),(0,r.jsx)("span",{className:`text-[11px] font-semibold ${e.is_correct?"text-accent":"text-destructive"}`,children:tl(e.selected_answer,e.options)})]}),!e.is_correct&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-[11px] font-medium text-muted-foreground",children:"Correct Answer:"}),(0,r.jsx)("span",{className:"text-[11px] font-semibold text-accent",children:tl(e.correct_answer,e.options)})]})]}),(0,r.jsx)("div",{className:"rounded-xl bg-muted/50 p-3",children:(0,r.jsxs)("p",{className:"text-[11px] leading-relaxed text-foreground",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Explanation: "}),e.explanation]})})]})})]})}var ti=s(1878),to=s(8368),tc=s(6962);let tx=["All","Physics","Chemistry","Mathematics"];function tm(){let{studentYear:e,authToken:t,studentLibraryData:s,setStudentLibraryData:l,studentLibraryDownloads:d,setStudentLibraryDownloads:i}=ep(),[o,c]=(0,a.useState)("All"),[x,m]=(0,a.useState)(""),[u,f]=(0,a.useState)(s||[]),[h,p]=(0,a.useState)(d||{}),[g,b]=(0,a.useState)(!s),[j,N]=(0,a.useState)(null),[v,y]=(0,a.useState)(null),[w,k]=(0,a.useState)(null),[A,S]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!t){N("Student login is required."),b(!1);return}b(!0),N(null),y(null);try{let[s,r]=await Promise.all([W(t,{subject:"All"===o?void 0:o}),Y(t)]);if(!e){f(s),l(s);let e=r.reduce((e,t)=>(e[t]=!0,e),{});p(e),i(e)}}catch(t){e||(t instanceof n?N(t.detail):N("Failed to load library items."))}finally{e||b(!1)}})(),()=>{e=!0}},[o,t,A]);let C=(0,a.useMemo)(()=>u.filter(e=>e.title.toLowerCase().includes(x.toLowerCase())),[u,x]),$=async e=>{if(t&&!w){y(null),k(e.id);try{let{blob:s,filename:r}=await V(t,e.id),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=r,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(a),p(t=>({...t,[e.id]:!0}))}catch(e){e instanceof n?y(e.detail):y("Download failed. Please try again.")}finally{k(null)}}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Library"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e||"12th"," Class - Study materials and resources"]})]}),j&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:j}),(0,r.jsx)("button",{onClick:()=>S(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),v&&(0,r.jsx)("div",{className:"rounded-2xl border border-destructive/30 bg-destructive/10 p-4 text-xs text-destructive",children:v}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(ti.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(eD,{placeholder:"Search materials...",value:x,onChange:e=>m(e.target.value),className:"rounded-xl border-border bg-card pl-10 text-foreground placeholder:text-muted-foreground"})]}),(0,r.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:tx.map(e=>(0,r.jsx)("button",{onClick:()=>c(e),className:`whitespace-nowrap rounded-full px-4 py-1.5 text-xs font-medium transition-colors ${o===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[g&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading materials..."})}),!g&&0===C.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No materials found"})}),!g&&C.map((e,t)=>{let s=!!h[e.id];return(0,r.jsxs)("div",{className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-border bg-card p-4",style:{animationDelay:`${80*t}ms`},children:[(0,r.jsx)("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl ${"Physics"===e.subject?"bg-primary/10":"Chemistry"===e.subject?"bg-accent/10":"Mathematics"===e.subject?"bg-warning/10":"bg-muted"}`,children:"PDF"===e.type||"DOCX"===e.type?(0,r.jsx)(to.A,{className:`h-6 w-6 ${"Physics"===e.subject?"text-primary":"Chemistry"===e.subject?"text-accent":"text-warning"}`}):(0,r.jsx)(eS.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.chapters," chapters"]}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.type}),e.file_name&&(0,r.jsx)("span",{className:"max-w-[180px] truncate text-xs text-muted-foreground",children:e.file_name})]})]}),(0,r.jsx)("button",{onClick:()=>{$(e)},disabled:w===e.id,className:`flex h-10 w-10 items-center justify-center rounded-xl ${s?"bg-accent/15":"bg-primary/10 hover:bg-primary/20"}`,"aria-label":s?"Downloaded":"Download",children:w===e.id?(0,r.jsx)("span",{className:"text-[10px] text-primary",children:"..."}):s?(0,r.jsx)(eZ.A,{className:"h-5 w-5 text-accent"}):(0,r.jsx)(tc.A,{className:"h-5 w-5 text-primary"})})]},e.id)})]})]})}var tu=s(1951),tf=s(5429);let th=["Physics","Chemistry","Mathematics"];function tp(){let{studentYear:e,authToken:t,studentProgressData:s,setStudentProgressData:l}=ep(),[d,i]=(0,a.useState)(s?.progress||null),[o,c]=(0,a.useState)(s?.summary||null),[x,m]=(0,a.useState)(s?.tests||[]),[u,f]=(0,a.useState)(!s),[h,p]=(0,a.useState)(null),[g,b]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!t){p("Student login is required."),f(!1);return}f(!0),p(null);try{let[s,r,a]=await Promise.all([J(t),I(t),O(t,{status:"completed"})]);e||(i(s),c(r),m(a),l({progress:s,summary:r,tests:a}))}catch(t){e||(t instanceof n?p(t.detail):p("Failed to load progress data."))}finally{e||f(!1)}})(),()=>{e=!0}},[t,g]);let j=(0,a.useMemo)(()=>th.map(e=>{let t=x.filter(t=>t.subject===e&&"number"==typeof t.score).map(e=>Number(e.score)).reverse().slice(-5),s=t.length>0?t:[0,0,0,0,0],r=s.reduce((e,t)=>e+t,0)/s.length;return{subject:e,scores:s,avg:r}}),[x]),N=d?.rank_history??[],v=d?.topic_mastery??[],y={Physics:eO.A,Chemistry:eB.A,Mathematics:eG.A};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"My Progress"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e||"12th"," Class - Track your JEE preparation journey"]})]}),h&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:h}),(0,r.jsx)("button",{onClick:()=>b(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(tu.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:u?"--":`#${d?.overall_rank??0}`}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Overall Rank"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent/15",children:(0,r.jsx)(tf.A,{className:"h-5 w-5 text-accent"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:u?"--":d?.total_students??0}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Total Students"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-warning/15",children:(0,r.jsx)(eH.A,{className:"h-5 w-5 text-warning"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:u?"--":o?.streak??0}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Day Streak"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(eQ.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:u?"--":d?.tests_completed??0}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Tests Done"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Subject-wise Marks"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4",children:j.map(e=>{let t=y[e.subject]||eC.A;return(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(t,{className:`h-4 w-4 ${"Physics"===e.subject?"text-primary":"Chemistry"===e.subject?"text-accent":"text-warning"}`}),(0,r.jsx)("span",{className:"text-xs font-semibold text-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"ml-auto text-xs font-bold text-primary",children:[e.avg.toFixed(1),"% avg"]})]}),(0,r.jsx)("div",{className:"flex items-end gap-1.5",children:e.scores.map((t,s)=>(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1",children:[(0,r.jsx)("div",{className:"w-full rounded-t-md bg-muted",style:{height:"60px"},children:(0,r.jsx)("div",{className:`w-full rounded-t-md transition-all ${"Physics"===e.subject?"bg-primary/70":"Chemistry"===e.subject?"bg-accent/70":"bg-warning/70"}`,style:{height:`${Math.max(0,Math.min(t,100))}%`,marginTop:`${60-Math.max(0,Math.min(t,100))/100*60}px`}})}),(0,r.jsxs)("span",{className:"text-[9px] text-muted-foreground",children:["T",s+1]})]},s))})]},e.subject)})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eJ.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Rank History"})]}),(0,r.jsx)("div",{className:"flex h-40 items-end gap-2",children:0===N.length?(0,r.jsx)("div",{className:"w-full text-center text-xs text-muted-foreground",children:"No history available"}):N.map((e,t)=>{let s=Math.max(...N.map(e=>e.rank)),a=(s-e.rank)/Math.max(s,1)*100+20;return(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-2",children:[(0,r.jsx)("span",{className:"text-[10px] font-medium text-muted-foreground",children:e.rank}),(0,r.jsx)("div",{className:"w-full rounded-t-lg bg-primary/80 transition-all",style:{height:`${a}%`}}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:e.week})]},`${e.week}-${t}`)})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-accent"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Topic Mastery"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:(0===v.length?[{topic:"General",mastery:0}]:v.map(e=>({topic:e.topic,mastery:e.mastery}))).map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.topic}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-muted-foreground",children:[e.mastery,"%"]})]}),(0,r.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full transition-all ${e.mastery>=85?"bg-accent":e.mastery>=70?"bg-primary":"bg-warning"}`,style:{width:`${Math.max(0,Math.min(e.mastery,100))}%`}})})]},e.topic))})]})]})}var tg=s(1767),tb=s(9363),tj=s(4961),tN=s(2869),tv=s(2289),ty=s(5118),tw=s(7420),tk=s(1313);let tA=[{icon:tg.A,label:"Notifications",screen:"notifications"},{icon:eR.A,label:"Privacy & Security",screen:null},{icon:tb.A,label:"Preferences",screen:null},{icon:tj.A,label:"Help & Support",screen:null}];function tS(){let{userName:e,userEmail:t,studentYear:s,authToken:l,navigate:d,setRole:i,clearAuth:o}=ep(),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(t||""),[f,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!l)return p("Student login is required.");p(null);try{let[t,s]=await Promise.all([h(l),J(l)]);e||(u(t.email),x(s))}catch(t){e||(t instanceof n?p(t.detail):p("Failed to load profile details."),x(null))}})(),()=>{e=!0}},[l]);let g=s||"12th",b="12th"===g?"2026":"2027";return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[f&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:f}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-primary/15",children:(0,r.jsx)(tN.A,{className:"h-10 w-10 text-primary"})}),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full bg-accent",children:(0,r.jsx)(tu.A,{className:"h-4 w-4 text-accent-foreground"})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-foreground",children:e||"Student"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["JEE ",b," Aspirant"]})]}),(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:c?.tests_completed??0}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Tests"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsxs)("span",{className:"text-base font-bold text-foreground",children:[c?.avg_score??0,"%"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Avg Score"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsxs)("span",{className:"text-base font-bold text-foreground",children:["#",c?.overall_rank??0]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Rank"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Profile Details"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(tv.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:m||t||"--"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(ty.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:"Not provided"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(e$.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"text-sm text-foreground",children:["Class ",g]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(tw.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"text-sm text-foreground",children:["Target: JEE Main ",b]})]})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1 rounded-2xl border border-border bg-card p-2",children:tA.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>e.screen&&d(e.screen),className:"flex items-center gap-3 rounded-xl px-3 py-3 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(t,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsx)("span",{className:"flex-1 text-left text-sm font-medium text-foreground",children:e.label}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-muted-foreground"})]},e.label)})}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>{o(),i(null),d("auth")},className:"gap-2 rounded-2xl border-destructive/30 bg-transparent py-5 text-destructive hover:bg-destructive/10 hover:text-destructive",children:[(0,r.jsx)(tk.A,{className:"h-4 w-4"}),"Sign Out"]})]})}let tC=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("textarea",{className:ew("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));tC.displayName="Textarea";var t$=s(4290),t_=s(6204);function tP(){let{navigate:e,authToken:t}=ep(),[s,l]=(0,a.useState)(0),[d,i]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1),[u,f]=(0,a.useState)(null),h=async()=>{if(!(s<=0)&&!x){if(!t)return void f("Student login is required.");m(!0),f(null);try{await K(t,{rating:s,feedback:d.trim()||void 0}),c(!0)}catch(e){e instanceof n?f(e.detail):f("Failed to submit feedback."),m(!1)}}};return o?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-6 px-6 py-20",children:[(0,r.jsx)("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-accent/15",children:(0,r.jsx)(t$.A,{className:"h-10 w-10 text-accent",fill:"hsl(var(--accent))"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Thank You!"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your feedback helps us improve JEE Prep Master."})]}),(0,r.jsx)(eA,{onClick:()=>e("student-home"),className:"rounded-2xl bg-primary px-8 py-5 text-primary-foreground",children:"Back to Home"})]}):(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>e("student-home"),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Feedback"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-6 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Rate Your Experience"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"How was your test experience?"})]}),(0,r.jsx)("div",{className:"flex gap-2",children:[1,2,3,4,5].map(e=>(0,r.jsx)("button",{onClick:()=>l(e),className:"transition-transform hover:scale-110","aria-label":`Rate ${e} stars`,children:(0,r.jsx)(t$.A,{className:`h-10 w-10 ${e<=s?"text-warning":"text-muted-foreground/30"}`,fill:e<=s?"hsl(var(--warning))":"none"})},e))}),(0,r.jsx)(tC,{placeholder:"Tell us more about your experience (optional)",value:d,onChange:e=>i(e.target.value),className:"min-h-28 rounded-xl border-border bg-background text-foreground placeholder:text-muted-foreground"}),u&&(0,r.jsx)("div",{className:"w-full rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:u}),(0,r.jsxs)(eA,{onClick:()=>void h(),disabled:0===s||x,className:"w-full gap-2 rounded-2xl bg-primary py-5 text-primary-foreground",children:[(0,r.jsx)(t_.A,{className:"h-4 w-4"}),x?"Submitting...":"Submit Feedback"]})]})]})}var tT=s(3545),tE=s(6950),tD=s(5777);function tM(){var e;let t,s,{navigate:l,authToken:d}=ep(),[i,o]=(0,a.useState)(null),[c,x]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[f,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[b,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(d)try{let e=await es(d);o(e)}catch(e){e instanceof n?u(e.detail):u("Failed to load study plan.")}finally{x(!1)}})()},[d]);let N=async e=>{if(d){x(!0);try{let t=await er(d,e.id);g(e),j(t),h(!0)}catch(e){console.error("Failed to generate quiz:",e),alert("Failed to generate quiz. Please try again.")}finally{x(!1)}}},v=async(e,t)=>{if(d){o(s=>s?{...s,tasks:s.tasks.map(s=>{if(s.id===e){let e=s.completed_subtopics||[],r=e.includes(t)?e.filter(e=>e!==t):[...e,t];return{...s,completed_subtopics:r}}return s})}:null);try{await el(d,e,t)}catch(e){console.error("Failed to toggle subtopic:",e)}}};if(c&&!f)return(0,r.jsx)("div",{className:"flex h-full items-center justify-center p-8",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-accent border-t-transparent"})});if(m)return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-8 text-center bg-background min-h-screen",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-destructive/10",children:(0,r.jsx)(tT.A,{className:"h-6 w-6 text-destructive"})}),(0,r.jsx)("p",{className:"text-muted-foreground",children:m}),(0,r.jsx)("button",{onClick:()=>l("student-home"),className:"text-sm font-medium text-accent hover:underline",children:"Go Back Home"})]});let y=i?(e=i.tasks,(t=new Date).setHours(0,0,0,0),s={overdue:[],today:[],upcomingWeeks:{},completed:[]},e.forEach(e=>{if("completed"===e.status)return void s.completed.push(e);let r=new Date(e.due_date);if(r.setHours(0,0,0,0),r<t)s.overdue.push(e);else if(r.getTime()===t.getTime())s.today.push(e);else{let a=Math.round(Math.abs((r.getTime()-t.getTime())/864e5)),l=(8-t.getDay())%7||7,n="";if(a<l)n="This Week";else if(a<l+7)n="Next Week";else{let e=new Date(r),t=e.getDay()||7;1!==t&&e.setHours(-24*(t-1)),n=`Week of ${e.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`}s.upcomingWeeks[n]||(s.upcomingWeeks[n]={});let d=r.toLocaleDateString(void 0,{weekday:"long",month:"short",day:"numeric"});s.upcomingWeeks[n][d]||(s.upcomingWeeks[n][d]=[]),s.upcomingWeeks[n][d].push(e)}}),s):null,w=i?Math.round(i.tasks.filter(e=>"completed"===e.status).length/i.tasks.length*100):0;return(0,r.jsxs)("div",{className:"flex min-h-screen flex-col bg-background pb-20 fade-in relative",children:[f&&b&&p&&(0,r.jsx)(tL,{authToken:d,attemptId:b.attempt_id,questions:b.questions,onComplete:e=>{h(!1),g(null),j(null),e&&p&&o(e=>e?{...e,tasks:e.tasks.map(e=>e.id===p.id?{...e,status:"completed",quiz_status:"passed"}:e)}:null)},onClose:()=>h(!1)}),(0,r.jsxs)("div",{className:"sticky top-0 z-10 border-b border-border/40 bg-background/80 px-4 py-3 backdrop-blur-md",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>l("student-home"),className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted/50 hover:bg-muted",children:(0,r.jsx)(eF.A,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-bold",children:"My Study Plan"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[w,"% Completed"]})]})]}),(0,r.jsx)("div",{className:"mt-3 h-1 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:"h-full bg-accent transition-all duration-500 ease-out",style:{width:`${w}%`}})})]}),(0,r.jsx)("div",{className:"flex-1 p-4 space-y-6",children:y&&(0,r.jsxs)(r.Fragment,{children:[y.overdue.length>0&&(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"mb-3 text-sm font-semibold text-destructive flex items-center gap-2",children:[(0,r.jsx)(tT.A,{className:"h-4 w-4"})," Overdue"]}),(0,r.jsx)("div",{className:"space-y-3",children:y.overdue.map(e=>(0,r.jsx)(tq,{task:e,onStartQuiz:()=>N(e),onToggleSubtopic:v},e.id))})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"mb-3 text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,r.jsx)(tw.A,{className:"h-4 w-4 text-accent"})," Today's Focus"]}),0===y.today.length?(0,r.jsx)("div",{className:"rounded-xl border border-dashed border-border p-6 text-center text-sm text-muted-foreground",children:"No tasks scheduled for today. caught up!"}):(0,r.jsx)("div",{className:"space-y-3",children:y.today.map(e=>(0,r.jsx)(tq,{task:e,onStartQuiz:()=>N(e),onToggleSubtopic:v,isToday:!0},e.id))})]}),Object.keys(y.upcomingWeeks).length>0&&(0,r.jsx)("div",{className:"space-y-8",children:Object.entries(y.upcomingWeeks).map(([e,t])=>(0,r.jsxs)("section",{children:[(0,r.jsx)("div",{className:"sticky top-[4.5rem] z-0 bg-background/95 backdrop-blur-sm py-2 mb-2 border-b border-border/50",children:(0,r.jsxs)("h2",{className:"text-sm font-bold text-foreground flex items-center gap-2",children:[(0,r.jsx)(eW.A,{className:"h-4 w-4 text-muted-foreground"})," ",e]})}),(0,r.jsx)("div",{className:"space-y-6 pl-2",children:Object.entries(t).map(([e,t])=>(0,r.jsxs)("div",{className:"relative pl-4 border-l-2 border-muted",children:[(0,r.jsx)("div",{className:"absolute -left-[5px] top-0 h-2.5 w-2.5 rounded-full bg-muted border border-background"}),(0,r.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground mb-3",children:e}),(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,r.jsx)(tq,{task:e,onStartQuiz:()=>N(e),onToggleSubtopic:v},e.id))})]},e))})]},e))}),y.completed.length>0&&(0,r.jsxs)("section",{className:"opacity-60",children:[(0,r.jsxs)("h2",{className:"mb-3 text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[(0,r.jsx)(eZ.A,{className:"h-4 w-4"})," Completed"]}),(0,r.jsx)("div",{className:"space-y-2",children:y.completed.slice(0,3).map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-muted/20 p-3",children:[(0,r.jsx)("div",{className:"h-5 w-5 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,r.jsx)(eZ.A,{className:"h-3 w-3 text-green-600"})}),(0,r.jsx)("span",{className:"text-sm line-through text-muted-foreground",children:e.title})]},e.id))})]})]})})]})}function tq({task:e,onStartQuiz:t,onToggleSubtopic:s,isToday:l=!1,minimal:n=!1}){let[d,i]=(0,a.useState)(!1),o={Physics:"bg-blue-500/10 text-blue-600 border-blue-200",Chemistry:"bg-purple-500/10 text-purple-600 border-purple-200",Mathematics:"bg-orange-500/10 text-orange-600 border-orange-200",default:"bg-accent/10 text-accent border-accent/20"},c=o[e.subject]||o.default,x=e.completed_subtopics||[],m=e.subtopics&&e.subtopics.length>0&&e.subtopics.every(e=>x.includes(e)),u=e.subtopics?.length===0||m;return(0,r.jsxs)("div",{className:`relative group flex flex-col rounded-xl border transition-all overflow-hidden
            ${l?"bg-background border-accent/30 shadow-sm":"bg-card/50 border-border"}
            ${n?"py-3 px-4":""}
        `,children:[n&&(0,r.jsx)("div",{className:"absolute -left-[21px] top-1/2 h-2 w-2 rounded-full bg-border -translate-y-1/2"}),(0,r.jsx)("div",{className:`flex flex-col gap-3 p-4 ${n?"py-0":""}`,onClick:()=>!n&&i(!d),children:(0,r.jsxs)("div",{className:"flex gap-3 cursor-pointer",children:[(0,r.jsx)("div",{className:"mt-0.5",children:"completed"===e.status?(0,r.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-green-500 text-white",children:(0,r.jsx)(eZ.A,{className:"h-3.5 w-3.5"})}):(0,r.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border border-muted-foreground/40",children:(0,r.jsx)(tE.A,{className:"h-4 w-4 text-muted-foreground/40"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:`mb-1 inline-flex items-center rounded-md border px-1.5 py-0.5 text-[10px] font-medium ${c}`,children:e.subject}),(0,r.jsx)("h3",{className:`font-medium leading-tight ${n?"text-sm":"text-base"}`,children:e.title})]}),!n&&(0,r.jsxs)("span",{className:"text-[10px] font-medium text-muted-foreground whitespace-nowrap",children:[e.duration_minutes," min"]})]}),(0,r.jsx)("p",{className:"mt-1 text-xs text-muted-foreground line-clamp-1",children:e.topic}),!n&&!d&&e.subtopics&&e.subtopics.length>0&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex-1 h-1 bg-muted rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-accent transition-all duration-300",style:{width:`${x.length/(e.subtopics.length||1)*100}%`}})}),(0,r.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[x.length,"/",e.subtopics.length]})]}),!n&&d&&(0,r.jsx)("div",{className:"mt-3 flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[(0,r.jsx)(eW.A,{className:"h-3 w-3"}),new Date(e.due_date).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})]}),(0,r.jsx)("button",{className:"p-1 hover:bg-muted rounded-full",children:(0,r.jsx)(tr.A,{className:"h-4 w-4 text-muted-foreground rotate-180"})})]})})]})]})}),!n&&d&&(0,r.jsxs)("div",{className:"border-t border-border bg-muted/10 p-4 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[e.subtopics&&e.subtopics.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Subtopics to Cover:"}),(0,r.jsx)("div",{className:"space-y-2",children:e.subtopics.map((t,a)=>{let l=x.includes(t);return(0,r.jsxs)("div",{onClick:r=>{r.stopPropagation(),s&&s(e.id,t)},className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30 cursor-pointer transition-colors",children:[(0,r.jsx)("div",{className:`h-4 w-4 rounded border flex items-center justify-center transition-colors
                                                 ${l?"bg-accent border-accent text-accent-foreground":"border-muted-foreground"}
                                             `,children:l&&(0,r.jsx)(eZ.A,{className:"h-3 w-3"})}),(0,r.jsx)("span",{className:`text-sm ${l?"text-muted-foreground line-through":"text-foreground"}`,children:t})]},a)})})]}):(0,r.jsx)("p",{className:"text-xs text-muted-foreground italic",children:"No specific subtopics listed. Focus on the main topic."}),(0,r.jsx)("div",{className:"mt-4 pt-3 border-t border-border flex justify-end",children:"completed"!==e.status?(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),u&&t()},disabled:!u,className:`flex items-center gap-2 px-4 py-2 rounded-full font-medium text-xs transition-all
                                    ${u?"bg-accent text-accent-foreground shadow-sm hover:brightness-110 active:scale-95":"bg-muted text-muted-foreground opacity-50 cursor-not-allowed"}
                                `,children:["in_progress"===e.quiz_status?"Resume Quiz":"Take Quiz",!u&&(0,r.jsx)(tD.A,{className:"h-3 w-3"})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600 text-sm font-medium",children:[(0,r.jsx)(eZ.A,{className:"h-4 w-4"}),"Task Completed"]})})]})]})}function tL({attemptId:e,authToken:t,questions:s,onComplete:l,onClose:n}){let[d,i]=(0,a.useState)(0),[o,c]=(0,a.useState)({}),[x,m]=(0,a.useState)(!1),[u,f]=(0,a.useState)(null),h=async()=>{m(!0);try{let s=await ea(t,e,o);f({passed:s.passed,score:s.score}),s.passed&&setTimeout(()=>l(!0),2e3)}catch(e){console.error("Quiz submission failed",e),alert("Failed to submit quiz.")}finally{m(!1)}};if(u)return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,r.jsx)("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-xl p-8 text-center border border-border",children:u.passed?(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"h-16 w-16 bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)(eZ.A,{className:"h-8 w-8 text-green-500"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Quiz Passed!"}),(0,r.jsxs)("p",{className:"text-muted-foreground mb-6",children:["Score: ",u.score,"%"]}),(0,r.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Task marked as completed."})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"h-16 w-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)(tT.A,{className:"h-8 w-8 text-red-500"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Quiz Failed"}),(0,r.jsxs)("p",{className:"text-muted-foreground mb-6",children:["Score: ",u.score,"% (Requires 60%)"]}),(0,r.jsx)("button",{onClick:n,className:"bg-accent text-accent-foreground px-6 py-2 rounded-lg font-medium",children:"Close & Try Later"})]})})});let p=s[d],g=(d+1)/s.length*100;return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"w-full max-w-lg bg-card rounded-2xl shadow-xl border border-border flex flex-col max-h-[90vh]",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-border flex items-center justify-between bg-muted/30 rounded-t-2xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-xs font-medium text-muted-foreground",children:["Question ",d+1," of ",s.length]}),(0,r.jsx)("div",{className:"h-1 w-32 bg-muted rounded-full mt-1 overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-accent transition-all duration-300",style:{width:`${g}%`}})})]}),(0,r.jsxs)("button",{onClick:n,className:"p-2 hover:bg-muted/50 rounded-full",children:[(0,r.jsx)(eF.A,{className:"h-4 w-4"})," "]})]}),(0,r.jsxs)("div",{className:"p-6 overflow-y-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-6",children:p.text}),(0,r.jsx)("div",{className:"space-y-3",children:p.options.map((e,t)=>(0,r.jsxs)("button",{onClick:()=>{let e;return e=s[d].id,void c(s=>({...s,[e]:t}))},className:`w-full text-left p-4 rounded-xl border transition-all text-sm
                                    ${o[p.id]===t?"border-accent bg-accent/5 ring-1 ring-accent":"border-border hover:bg-muted/30 hover:border-muted-foreground/30"}
                                `,children:[(0,r.jsxs)("span",{className:"inline-block w-6 font-medium text-muted-foreground",children:[String.fromCharCode(65+t),"."]}),e]},t))})]}),(0,r.jsx)("div",{className:"p-4 border-t border-border bg-muted/30 rounded-b-2xl flex justify-end",children:(0,r.jsxs)("button",{onClick:()=>{d<s.length-1?i(e=>e+1):h()},disabled:void 0===o[p.id]||x,className:"bg-accent text-accent-foreground px-6 py-2 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[x&&(0,r.jsx)("div",{className:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"}),d===s.length-1?"Submit":"Next"]})})]})})}var tF=s(1975),tR=s(8307),tz=s(2129);function tU(){let{userName:e,navigate:t,teacherSubject:s,authToken:l,teacherHomeData:d,setTeacherHomeData:i}=ep(),[o,c]=(0,a.useState)(d?.summary||null),[x,m]=(0,a.useState)(d?.classes||[]),[u,f]=(0,a.useState)(d?.papers||[]),[h,p]=(0,a.useState)(d?.lessons||[]),[g,b]=(0,a.useState)(!d),[j,N]=(0,a.useState)(null),[v,y]=(0,a.useState)(0),w=s||"Physics";(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!l){N("Teacher login is required."),b(!1);return}b(!0),N(null);try{let[t,s,r,a]=await Promise.all([A(l),P(l),S(l),M(l)]);e||(c(t),m(s),f(r),p(a),i({summary:t,classes:s,papers:r,lessons:a}))}catch(t){e||(t instanceof n?N(t.detail):N("Failed to load teacher dashboard."))}finally{e||b(!1)}})(),()=>{e=!0}},[l,v]);let k=(0,a.useMemo)(()=>h.slice(0,2),[h]),C=(0,a.useMemo)(()=>u.slice(0,3),[u]);return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-4",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-1",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Welcome back,"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-foreground text-balance",children:e||"Teacher"}),(0,r.jsxs)("span",{className:"mt-1 w-fit rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold text-primary",children:[w," Teacher"]})]}),g&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading teacher dashboard..."}),!g&&j&&(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:j}),(0,r.jsx)("button",{onClick:()=>y(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),!g&&!j&&o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"animate-fade-in flex gap-3",style:{animationDelay:"100ms"},children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(tf.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:o.total_students}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Students"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent/15",children:(0,r.jsx)(to.A,{className:"h-5 w-5 text-accent"})}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:o.total_papers}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Papers"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-warning/15",children:(0,r.jsx)(eJ.A,{className:"h-5 w-5 text-warning"})}),(0,r.jsxs)("span",{className:"text-lg font-bold text-foreground",children:[o.subject_avg,"%"]}),(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[w," Avg"]})]})]}),(0,r.jsxs)("button",{onClick:()=>t("teacher-paper-generator"),className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-primary/20 bg-primary/5 p-4 text-left transition-colors hover:bg-primary/10",style:{animationDelay:"200ms"},children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary",children:(0,r.jsx)(eY.A,{className:"h-6 w-6 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"AI Paper Generator"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Create custom ",w," papers with AI"]})]}),(0,r.jsx)(eP.A,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)("button",{onClick:()=>t("teacher-library"),className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-warning/20 bg-warning/5 p-4 text-left transition-colors hover:bg-warning/10",style:{animationDelay:"225ms"},children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-warning",children:(0,r.jsx)(tF.A,{className:"h-6 w-6 text-warning-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Upload Materials"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Add files for student library"})]}),(0,r.jsx)(eP.A,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)("button",{onClick:()=>t("teacher-lesson-plans"),className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-accent/20 bg-accent/5 p-4 text-left transition-colors hover:bg-accent/10",style:{animationDelay:"250ms"},children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-accent",children:(0,r.jsx)(tR.A,{className:"h-6 w-6 text-accent-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Lesson Plans"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[h.length," plans available"]})]}),(0,r.jsx)(eP.A,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"300ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Class Performance"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[0===x.length&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"No classes yet."}),x.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.name}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-muted-foreground",children:[e.avg_score,"%"]})]}),(0,r.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full ${e.avg_score>=80?"bg-accent":e.avg_score>=70?"bg-primary":"bg-warning"}`,style:{width:`${e.avg_score}%`}})})]},e.id))]})]}),k.length>0&&(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"350ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Recent Lesson Plans"}),(0,r.jsxs)("button",{onClick:()=>t("teacher-lesson-plans"),className:"flex items-center gap-1 text-xs font-medium text-primary",children:["View All ",(0,r.jsx)(e_.A,{className:"h-3 w-3"})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:k.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-accent/10",children:(0,r.jsx)(tz.A,{className:"h-6 w-6 text-accent"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.topic}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.year}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.duration," min"]})]})]}),(0,r.jsx)("span",{className:`rounded-full px-2.5 py-1 text-[10px] font-medium ${"published"===e.status?"bg-accent/15 text-accent":"bg-muted text-muted-foreground"}`,children:e.status})]},e.id))})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"400ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Recent Papers"}),(0,r.jsxs)("button",{onClick:()=>t("teacher-tests"),className:"flex items-center gap-1 text-xs font-medium text-primary",children:["View All ",(0,r.jsx)(e_.A,{className:"h-3 w-3"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[0===C.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-4 text-xs text-muted-foreground",children:"No papers yet."}),C.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10",children:(0,r.jsx)(to.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.questions," Qs"]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.duration," min"]})]})]}),(0,r.jsx)("span",{className:`rounded-full px-2.5 py-1 text-[10px] font-medium ${e.assigned?"bg-accent/15 text-accent":"bg-muted text-muted-foreground"}`,children:e.assigned?`${e.students} students`:"Draft"})]},e.id))]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"500ms"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"My Classes"}),(0,r.jsxs)("button",{onClick:()=>t("teacher-classes"),className:"flex items-center gap-1 text-xs font-medium text-primary",children:["View All ",(0,r.jsx)(e_.A,{className:"h-3 w-3"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[0===x.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-4 text-xs text-muted-foreground",children:"No classes created yet."}),x.map(e=>(0,r.jsxs)("button",{onClick:()=>t("teacher-classes"),className:"flex items-center gap-4 rounded-2xl border border-border bg-card p-4 text-left transition-colors hover:bg-muted/50",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-accent/10",children:(0,r.jsx)(tf.A,{className:"h-6 w-6 text-accent"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.name}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.students," students"]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-0.5",children:[(0,r.jsxs)("span",{className:"text-sm font-bold text-primary",children:[e.avg_score,"%"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"avg score"})]})]},e.id))]})]})]})]})}var tI=s(1914),tO=s(3210);function tB(){let{navigate:e,authToken:t}=ep(),[s,l]=(0,a.useState)([]),[d,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[g,b]=(0,a.useState)(0),[j,N]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[w,k]=(0,a.useState)([]),[A,C]=(0,a.useState)(!1),[T,E]=(0,a.useState)(!1),[D,M]=(0,a.useState)(null),[q,L]=(0,a.useState)(null),[F,R]=(0,a.useState)(!1),[z,U]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!t){m("Teacher login is required."),c(!1);return}c(!0),m(null),f(null),p(null);try{let[s,r]=await Promise.allSettled([S(t),P(t)]);if(e)return;if("fulfilled"===s.status)l(s.value),m(null);else{let e=s.reason;l([]),m(e instanceof n?e.detail:"Failed to load papers.")}if("fulfilled"===r.status)i(r.value),f(null);else{let e=r.reason;i([]),f(e instanceof n?e.detail:"Classes unavailable right now.")}}catch{e||(l([]),i([]),m("Failed to load papers."),f("Classes unavailable right now."))}finally{e||c(!1)}})(),()=>{e=!0}},[t,g]);let I=(0,a.useMemo)(()=>s.find(e=>e.id===v)??null,[v,s]),O=()=>{N(!1),y(null),k([]),C(!1),p(null)},B=async e=>{if(t&&!F){E(!0),M(e),L(null),U(null),R(!0);try{let s=await $(t,e);L(s)}catch(e){e instanceof n?U(e.detail):U("Unable to load paper details.")}finally{R(!1)}}},G=async()=>{if(!t||!v||A)return;if(0===w.length)return void p("Select at least one class.");C(!0),p(null);let e=!1;try{let s=await _(t,v,w);l(e=>e.map(e=>e.id===s.id?s:e)),e=!0}catch(e){e instanceof n?p(e.detail):p("Unable to assign paper.")}finally{e?O():C(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"My Papers"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:o?"Loading...":`${s.length} papers created`})]}),(0,r.jsxs)(eA,{onClick:()=>e("teacher-paper-generator"),className:"gap-2 rounded-xl bg-primary text-primary-foreground",size:"sm",children:[(0,r.jsx)(tI.A,{className:"h-4 w-4"}),"New"]})]}),h&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:h}),u&&(0,r.jsx)("div",{className:"rounded-xl border border-warning/30 bg-warning/10 px-3 py-2 text-xs text-warning",children:u}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:o?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading papers..."}):x?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:x}),(0,r.jsx)("button",{onClick:()=>b(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===s.length?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center text-sm text-muted-foreground",children:"No papers created yet."}):s.map((t,s)=>(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:`${80*s}ms`},children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10",children:(0,r.jsx)(to.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:t.title}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,r.jsx)(tw.A,{className:"h-3 w-3"}),t.created_at?new Date(t.created_at).toLocaleDateString():"-"]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.questions," Qs"]}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.duration," min"]})]})]}),(0,r.jsx)("span",{className:`rounded-full px-2.5 py-1 text-[10px] font-medium ${t.assigned?"bg-accent/15 text-accent":"bg-warning/15 text-warning"}`,children:t.assigned?"Assigned":"Draft"})]}),t.assigned&&(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-xl bg-muted/50 p-3",children:[(0,r.jsx)(tf.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Assigned to ",t.students," students"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(eA,{variant:"outline",size:"sm",className:"flex-1 rounded-lg bg-transparent text-xs text-foreground",onClick:()=>void B(t.id),children:"View Paper"}),(0,r.jsx)(eA,{variant:"outline",size:"sm",className:"flex-1 rounded-lg bg-transparent text-xs text-foreground",onClick:()=>e("teacher-paper-generator"),children:"Create Similar"}),!t.assigned&&(0,r.jsx)(eA,{size:"sm",className:"flex-1 rounded-lg bg-primary text-xs text-primary-foreground",disabled:!!u,onClick:()=>{y(t.id),k([]),p(null),N(!0)},children:u?"Classes Unavailable":"Assign to Class"})]})]},t.id))}),(0,r.jsxs)("button",{onClick:()=>e("teacher-paper-generator"),className:"flex items-center gap-4 rounded-2xl border-2 border-dashed border-border p-6 transition-colors hover:border-primary/50 hover:bg-primary/5",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/10",children:(0,r.jsx)(eY.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Generate New Paper with AI"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Create customized JEE papers instantly"})]})]}),T&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:"Paper Preview"}),(0,r.jsx)("button",{onClick:()=>{E(!1),M(null),L(null),R(!1),U(null)},className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),F?(0,r.jsx)("div",{className:"rounded-xl border border-border bg-background p-4 text-sm text-muted-foreground",children:"Loading paper details..."}):z?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:z}),D&&(0,r.jsx)(eA,{size:"sm",className:"w-fit rounded-lg bg-primary text-primary-foreground",onClick:()=>void B(D),children:"Retry"})]}):q?(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-border bg-background p-3",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-foreground",children:q.title}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:[q.subject," | ",q.difficulty," | ",q.questions," Qs |"," ",q.duration," min"]}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["Source:"," ","ai"===(q.question_source||"template").toLowerCase()?"AI Generated":"Template"]})]}),(0,r.jsx)("div",{className:"max-h-[65vh] overflow-y-auto pr-1",children:0===(q.question_set??[]).length?(0,r.jsx)("div",{className:"rounded-xl border border-border bg-background p-4 text-xs text-muted-foreground",children:"No question details found for this paper."}):(0,r.jsx)("div",{className:"flex flex-col gap-3",children:(q.question_set??[]).map((e,t)=>(0,r.jsxs)("div",{className:"rounded-xl border border-border bg-background p-3",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-foreground",children:["Q",t+1,". ",e.text]}),(0,r.jsx)("div",{className:"mt-2 grid gap-2",children:e.options.map((t,s)=>(0,r.jsxs)("div",{className:`rounded-lg border px-3 py-2 text-xs ${s===e.correct?"border-accent/40 bg-accent/10 text-accent":"border-border text-foreground"}`,children:[String.fromCharCode(65+s),". ",t]},`${e.id}-${s}`))}),(0,r.jsxs)("p",{className:"mt-2 text-[11px] font-medium text-muted-foreground",children:["Correct: ",String.fromCharCode(65+e.correct)]}),(0,r.jsx)("p",{className:"mt-1 text-[11px] text-muted-foreground",children:e.explanation})]},`${e.id}-${t}`))})})]}):(0,r.jsx)("div",{className:"rounded-xl border border-border bg-background p-4 text-xs text-muted-foreground",children:"Select a paper to preview."})]})}),j&&I&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-lg animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:"Assign Paper"}),(0,r.jsx)("button",{onClick:O,className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"mb-3 text-xs text-muted-foreground",children:I.title}),(0,r.jsxs)("div",{className:"flex max-h-64 flex-col gap-2 overflow-y-auto",children:[u&&(0,r.jsx)("div",{className:"rounded-xl border border-warning/30 bg-warning/10 p-3 text-xs text-warning",children:u}),0===d.length&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-xl border border-border bg-background p-3",children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"No classes available. Create one first, then assign this paper."}),(0,r.jsx)(eA,{size:"sm",variant:"outline",className:"w-fit rounded-lg bg-transparent text-xs text-foreground",onClick:()=>{O(),e("teacher-classes")},children:"Create Class"})]}),d.map(e=>(0,r.jsxs)("button",{onClick:()=>{var t;return t=e.id,void k(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:`flex items-center justify-between rounded-xl border px-3 py-3 text-left text-sm transition-colors ${w.includes(e.id)?"border-primary bg-primary/10":"border-border bg-background"}`,children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:e.name}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.students," students"]})]},e.id))]}),(0,r.jsx)(eA,{onClick:G,disabled:A||0===d.length||!!u||0===w.length,className:"mt-4 w-full rounded-xl bg-primary py-5 text-primary-foreground",children:A?"Assigning...":"Assign Paper"})]})})]})}let tG=["Easy","Medium","Hard","Mixed"],tH=["JEE Main","JEE Advanced","Custom"],tQ={Physics:{"11th":["Units & Measurements","Kinematics","Laws of Motion","Work, Energy & Power","Rotational Motion","Gravitation","Properties of Matter","Thermodynamics","Oscillations","Waves"],"12th":["Electric Charges & Fields","Electrostatic Potential","Current Electricity","Magnetism","Electromagnetic Induction","AC Circuits","EM Waves","Ray Optics","Wave Optics","Dual Nature of Radiation","Atoms","Nuclei","Semiconductors"]},Chemistry:{"11th":["Some Basic Concepts","Atomic Structure","Classification of Elements","Chemical Bonding","States of Matter","Thermodynamics","Equilibrium","Redox Reactions","Hydrogen","s-Block Elements","Organic Chemistry Basics","Hydrocarbons"],"12th":["Solid State","Solutions","Electrochemistry","Chemical Kinetics","Surface Chemistry","Isolation of Elements","p-Block Elements","d & f Block Elements","Coordination Compounds","Haloalkanes","Alcohols & Phenols","Aldehydes & Ketones","Amines","Biomolecules","Polymers"]},Mathematics:{"11th":["Sets","Relations & Functions","Trigonometric Functions","Complex Numbers","Linear Inequalities","Permutations & Combinations","Binomial Theorem","Sequences & Series","Straight Lines","Conic Sections","Limits & Derivatives","Statistics","Probability"],"12th":["Relations & Functions","Inverse Trig Functions","Matrices","Determinants","Continuity & Differentiability","Applications of Derivatives","Integrals","Applications of Integrals","Differential Equations","Vectors","3D Geometry","Linear Programming","Probability"]}};function tJ(){let{navigate:e,teacherSubject:t,authToken:s}=ep(),l=t||"Physics",[d,i]=(0,a.useState)("12th"),[o,c]=(0,a.useState)(""),[x,m]=(0,a.useState)([]),[u,f]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[g,b]=(0,a.useState)("30"),[j,N]=(0,a.useState)("60"),[v,y]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null),[A,S]=(0,a.useState)(null),$=tQ[l]?.[d]||[],_=(0,a.useMemo)(()=>{let e=Number(g),t=Number(j);return!!(u&&h&&e>=5&&t>=10)},[u,h,g,j]),P=async()=>{if(s&&_&&!v){S(null),y(!0);try{let e=x.length>0?`${x[0]} - `:"",t=o?`${o} - `:"",r=`${t}${e}${h} ${l} Practice`,a=await C(s,{title:r,subject:l,difficulty:u,questions:Number(g),duration:Number(j),year:d,topic:o||void 0});k(a)}catch(e){e instanceof n?S(e.detail):S("Failed to generate paper.")}finally{y(!1)}}};return w?(0,r.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex w-full max-w-2xl flex-col items-center gap-6 animate-scale-in",children:[(0,r.jsx)("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-accent/15",children:(0,r.jsx)(eZ.A,{className:"h-10 w-10 text-accent"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Paper Generated!"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your paper has been created and saved as draft."})]}),(0,r.jsxs)("div",{className:"flex w-full flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Title"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:w.title})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Subject"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:w.subject})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Year"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:w.year})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Questions"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:w.questions})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Duration"}),(0,r.jsxs)("span",{className:"text-xs font-medium text-foreground",children:[w.duration," min"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Status"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:w.status})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Source"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:"ai"===(w.question_source||"template").toLowerCase()?"AI Generated":"Template"})]})]}),(w.question_set??[]).length>0&&(0,r.jsxs)("div",{className:"flex w-full flex-col gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("h3",{className:"text-xs font-semibold text-foreground",children:"Preview Questions"}),(w.question_set??[]).slice(0,3).map((e,t)=>(0,r.jsxs)("div",{className:"rounded-lg bg-muted/50 p-2",children:[(0,r.jsxs)("p",{className:"text-[11px] font-medium text-foreground",children:["Q",t+1,". ",e.text]}),(0,r.jsxs)("p",{className:"mt-1 text-[10px] text-muted-foreground",children:["Answer: ",String.fromCharCode(65+e.correct)]})]},`${e.id}-${t}`)),(w.question_set??[]).length>3&&(0,r.jsxs)("p",{className:"text-[10px] text-muted-foreground",children:["+",(w.question_set??[]).length-3," more questions in View Papers."]})]}),(0,r.jsxs)("div",{className:"flex w-full gap-3",children:[(0,r.jsx)(eA,{variant:"outline",onClick:()=>e("teacher-tests"),className:"flex-1 rounded-xl bg-transparent py-5 text-foreground",children:"View Papers"}),(0,r.jsx)(eA,{onClick:()=>{k(null),m([]),f(""),p("")},className:"flex-1 rounded-xl bg-primary py-5 text-primary-foreground",children:"Create Another"})]})]})}):v?(0,r.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,r.jsxs)("div",{className:"relative flex h-20 w-20 items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-muted"}),(0,r.jsx)("div",{className:"absolute inset-0 animate-spin rounded-full border-4 border-transparent border-t-primary"}),(0,r.jsx)(eY.A,{className:"h-8 w-8 text-primary"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Generating Paper..."}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["AI is creating ",g," ",l," questions."]})]})]})}):(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>e("teacher-home"),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"AI Paper Generator"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Create custom ",l," papers with AI"]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Subject"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-border bg-muted/50 p-3 opacity-80",children:[(0,r.jsx)(tD.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:l}),(0,r.jsx)("span",{className:"ml-auto text-[10px] text-muted-foreground",children:"Locked to your specialization"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Select Year"}),(0,r.jsx)("div",{className:"flex gap-3",children:["11th","12th"].map(e=>(0,r.jsxs)("button",{onClick:()=>{i(e),m([])},className:`flex-1 rounded-xl py-3 text-sm font-medium transition-colors ${d===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:[e," Class"]},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Chapters (optional)"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:$.map(e=>(0,r.jsx)("button",{onClick:()=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},className:`rounded-full px-3 py-1.5 text-[11px] font-medium transition-colors ${x.includes(e)?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Exam Pattern"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:tH.map(e=>(0,r.jsx)("button",{onClick:()=>p(e),className:`rounded-full px-4 py-2 text-xs font-medium transition-colors ${h===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Difficulty Level"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:tG.map(e=>(0,r.jsx)("button",{onClick:()=>f(e),className:`rounded-full px-4 py-2 text-xs font-medium transition-colors ${u===e?"Easy"===e?"bg-accent text-accent-foreground":"Hard"===e?"bg-destructive text-destructive-foreground":"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Number of Questions"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(to.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)(eD,{type:"number",value:g,onChange:e=>b(e.target.value),className:"rounded-xl border-border bg-card text-foreground",min:"5",max:"200"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eL,{className:"text-sm font-medium text-foreground",children:"Duration (minutes)"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(eW.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)(eD,{type:"number",value:j,onChange:e=>N(e.target.value),className:"rounded-xl border-border bg-card text-foreground",min:"10",max:"360"})]})]}),A&&(0,r.jsx)("p",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:A}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)(eA,{onClick:P,disabled:!_||!s,className:"w-full gap-2 rounded-2xl bg-primary py-6 text-base font-semibold text-primary-foreground",size:"lg",children:[(0,r.jsx)(eY.A,{className:"h-5 w-5"}),"Generate ",l," Paper with AI"]})})]})}let tW={title:"",subject:"Physics",type:"PDF",chapters:"10",year:"12th",file:null};function tY(){let{authToken:e,teacherSubject:t}=ep(),[s,l]=(0,a.useState)(""),[d,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),[h,p]=(0,a.useState)(0),[g,b]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[v,y]=(0,a.useState)({...tW,subject:t??"Physics"});(0,a.useEffect)(()=>{let t=!1;return(async()=>{if(!e){m("Teacher login is required."),c(!1);return}c(!0),m(null);try{let s=await z(e);t||i(s)}catch(e){t||(e instanceof n?m(e.detail):m("Failed to load library items."),i([]))}finally{t||c(!1)}})(),()=>{t=!0}},[e,h]);let w=(0,a.useMemo)(()=>d.filter(e=>e.title.toLowerCase().includes(s.toLowerCase())),[d,s]),k=(0,a.useMemo)(()=>({pdfs:d.filter(e=>"PDF"===e.type).length,qbanks:d.filter(e=>"Question Bank"===e.type).length,chapters:d.reduce((e,t)=>e+t.chapters,0)}),[d]),A=()=>{b(!1),f(null),N(!1),y({...tW,subject:t??"Physics"})},S=async()=>{if(!e||j)return;let t=v.title.trim(),s=Number(v.chapters),r=v.file;if(!t)return void f("Title is required.");if(!Number.isFinite(s)||s<1)return void f("Chapters must be at least 1.");if(!r)return void f("Please choose a file to upload.");f(null),N(!0);try{let a=await U(e,{title:t,subject:v.subject,type:v.type,chapters:s,year:v.year,file:r,publishNow:!0});i(e=>[a,...e]),A()}catch(e){e instanceof n?f(e.detail):f("Unable to upload material."),N(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Library"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage study materials"})]}),(0,r.jsxs)(eA,{className:"gap-2 rounded-xl bg-primary text-primary-foreground",size:"sm",onClick:()=>b(!0),children:[(0,r.jsx)(tF.A,{className:"h-4 w-4"}),"Upload"]})]}),u&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:u}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(ti.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(eD,{placeholder:"Search materials...",value:s,onChange:e=>l(e.target.value),className:"rounded-xl border-border bg-card pl-10 text-foreground placeholder:text-muted-foreground"})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-3",children:[(0,r.jsx)(to.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:k.pdfs}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"PDFs"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-3",children:[(0,r.jsx)(eS.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:k.qbanks}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Q Banks"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-3",children:[(0,r.jsx)(tz.A,{className:"h-5 w-5 text-warning"}),(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:k.chapters}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Chapters"})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:o?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading materials..."}):x?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:x}),(0,r.jsx)("button",{onClick:()=>p(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===w.length?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No materials found"})}):w.map((e,t)=>(0,r.jsxs)("div",{className:"animate-fade-in flex items-center gap-4 rounded-2xl border border-border bg-card p-4",style:{animationDelay:`${80*t}ms`},children:[(0,r.jsx)("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl ${"Physics"===e.subject?"bg-primary/10":"Chemistry"===e.subject?"bg-accent/10":"Mathematics"===e.subject?"bg-warning/10":"bg-muted"}`,children:(0,r.jsx)(to.A,{className:`h-6 w-6 ${"Physics"===e.subject?"text-primary":"Chemistry"===e.subject?"text-accent":"Mathematics"===e.subject?"text-warning":"text-muted-foreground"}`})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.chapters," chapters"]}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:e.type}),e.file_name&&(0,r.jsx)("span",{className:"max-w-[200px] truncate text-xs text-muted-foreground",children:e.file_name}),(0,r.jsx)("span",{className:`rounded-full px-2 py-0.5 text-[10px] font-medium ${"approved"===e.status?"bg-accent/15 text-accent":"pending"===e.status?"bg-warning/15 text-warning":"bg-muted text-muted-foreground"}`,children:e.status??"available"})]})]})]},e.id))}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-lg animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:"Upload Material"}),(0,r.jsx)("button",{onClick:A,className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(eD,{value:v.title,onChange:e=>y(t=>({...t,title:e.target.value})),placeholder:"Title",className:"rounded-xl border-border bg-background text-foreground"}),(0,r.jsx)("select",{value:v.subject,onChange:e=>y(t=>({...t,subject:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground",children:["Physics","Chemistry","Mathematics","All"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)("select",{value:v.type,onChange:e=>y(t=>({...t,type:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground",children:["PDF","Question Bank","DOCX","Image"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)(eD,{type:"file",accept:"PDF"===v.type?".pdf,application/pdf":"DOCX"===v.type?".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Image"===v.type?"image/*":".pdf,.docx,.txt,.csv,.md,application/pdf,text/plain",onChange:e=>y(t=>({...t,file:e.target.files&&e.target.files.length>0?e.target.files[0]:null})),className:"rounded-xl border-border bg-background text-foreground file:mr-3 file:rounded-md file:border-0 file:bg-primary/10 file:px-3 file:py-2 file:text-xs file:font-medium file:text-primary"}),v.file&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Selected: ",v.file.name," (",Math.max(1,Math.round(v.file.size/1024))," KB)"]}),(0,r.jsx)(eD,{type:"number",min:"1",value:v.chapters,onChange:e=>y(t=>({...t,chapters:e.target.value})),placeholder:"Chapters",className:"rounded-xl border-border bg-background text-foreground"}),(0,r.jsxs)("select",{value:v.year,onChange:e=>y(t=>({...t,year:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground",children:[(0,r.jsx)("option",{value:"11th",children:"11th"}),(0,r.jsx)("option",{value:"12th",children:"12th"})]}),(0,r.jsx)(eA,{onClick:S,disabled:j,className:"mt-2 w-full rounded-xl bg-primary py-5 text-primary-foreground",children:j?"Uploading...":"Upload"}),(0,r.jsx)("p",{className:"text-[11px] text-muted-foreground",children:"Uploaded material is published for student download immediately."})]})]})})]})}let tV={name:"",year:"12th",subject:"Physics"};function tK(){let{authToken:e,teacherSubject:t,navigate:s,setSelectedStudentId:l}=ep(),[d,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),[h,p]=(0,a.useState)(0),[g,b]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[v,y]=(0,a.useState)({...tV,subject:t??"Physics"}),[w,k]=(0,a.useState)(!1),[A,S]=(0,a.useState)(null),[C,$]=(0,a.useState)(!1),[_,M]=(0,a.useState)(null),[q,L]=(0,a.useState)([]),[F,R]=(0,a.useState)([]),[z,U]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let t=!1;return(async()=>{if(!e){m("Teacher login is required."),c(!1);return}c(!0),m(null);try{let s=await P(e);t||i(s)}catch(e){t||(e instanceof n?m(e.detail):m("Failed to load classes."),i([]))}finally{t||c(!1)}})(),()=>{t=!0}},[e,h]);let I=(0,a.useMemo)(()=>({totalStudents:d.reduce((e,t)=>e+t.students,0),avg:d.length>0?Math.round(d.reduce((e,t)=>e+t.avg_score,0)/d.length):0}),[d]),O=()=>{b(!1),f(null),N(!1),y({...tV,subject:t??"Physics"})},B=async()=>{if(!e||j)return;let t=v.name.trim();if(!t)return void f("Class name is required.");N(!0),f(null);try{let s=await T(e,{name:t,year:v.year,subject:v.subject});i(e=>[s,...e]),O()}catch(e){e instanceof n?f(e.detail):f("Unable to create class."),N(!1)}},G=async t=>{if(e){S(t),k(!0),$(!0),M(null),U(!1),L([]),R([]);try{let s=await E(e,t.id);L(s),R(s.filter(e=>e.assigned).map(e=>e.id))}catch(e){e instanceof n?M(e.detail):M("Failed to load class students.")}finally{$(!1)}}},H=()=>{k(!1),S(null),$(!1),M(null),L([]),R([]),U(!1)},Q=async()=>{if(e&&A&&!z){U(!0),M(null);try{let t=await D(e,A.id,F);i(e=>e.map(e=>e.id===t.id?t:e)),H()}catch(e){e instanceof n?M(e.detail):M("Unable to update class students.")}finally{U(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"My Classes"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:o?"Loading...":`${d.length} active classes`})]}),(0,r.jsxs)(eA,{className:"gap-2 rounded-xl bg-primary text-primary-foreground",size:"sm",onClick:()=>b(!0),children:[(0,r.jsx)(tI.A,{className:"h-4 w-4"}),"Add"]})]}),u&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:u}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(tf.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-lg font-bold text-foreground",children:I.totalStudents}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Total Students"})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(eJ.A,{className:"h-5 w-5 text-accent"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-foreground",children:[I.avg,"%"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Overall Avg"})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:o?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading classes..."}):x?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:x}),(0,r.jsx)("button",{onClick:()=>p(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===d.length?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center text-sm text-muted-foreground",children:"No classes created yet."}):d.map((e,t)=>(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-4 rounded-2xl border border-border bg-card p-4",style:{animationDelay:`${100*t}ms`},children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10",children:(0,r.jsx)(tf.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.name}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[e.subject," | ",e.year," | ",e.students," students"]})]}),(0,r.jsx)(eP.A,{className:"h-5 w-5 text-muted-foreground"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl bg-muted/50 p-3",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Average Score"}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-foreground",children:[e.avg_score,"%"]})]}),(0,r.jsx)("div",{className:"h-1.5 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full ${e.avg_score>=75?"bg-accent":e.avg_score>=65?"bg-primary":"bg-warning"}`,style:{width:`${e.avg_score}%`}})})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(eA,{variant:"outline",size:"sm",className:"flex-1 rounded-lg bg-transparent text-xs text-foreground",onClick:()=>G(e),children:"Manage Students"}),(0,r.jsx)(eA,{size:"sm",className:"flex-1 rounded-lg bg-primary text-xs text-primary-foreground",onClick:()=>s("teacher-tests"),children:"Assign Test"})]})]},e.id))}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-lg animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:"Create Class"}),(0,r.jsx)("button",{onClick:O,className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("input",{type:"text",value:v.name,onChange:e=>y(t=>({...t,name:e.target.value})),placeholder:"Class name",className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground"}),(0,r.jsx)("select",{value:v.subject,onChange:e=>y(t=>({...t,subject:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground",children:["Physics","Chemistry","Mathematics"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsxs)("select",{value:v.year,onChange:e=>y(t=>({...t,year:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground",children:[(0,r.jsx)("option",{value:"11th",children:"11th"}),(0,r.jsx)("option",{value:"12th",children:"12th"})]}),(0,r.jsx)(eA,{onClick:B,disabled:j,className:"mt-2 w-full rounded-xl bg-primary py-5 text-primary-foreground",children:j?"Creating...":"Create Class"})]})]})}),w&&A&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-lg animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:A.name}),(0,r.jsx)("button",{onClick:H,className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("p",{className:"mb-3 text-xs text-muted-foreground",children:[A.year," | Select students for this class"]}),(0,r.jsx)("div",{className:"max-h-72 overflow-y-auto",children:C?(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading students..."}):_?(0,r.jsx)("p",{className:"text-sm text-destructive",children:_}):0===q.length?(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["No active students available for ",A.year," yet."]}):(0,r.jsx)("div",{className:"flex flex-col gap-2",children:q.map(e=>(0,r.jsxs)("div",{className:`flex w-full items-center justify-between rounded-xl border px-3 py-2 transition-colors ${F.includes(e.id)?"border-primary bg-primary/10":"border-border bg-background"}`,children:[(0,r.jsxs)("button",{onClick:()=>{var t;return t=e.id,void R(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"flex flex-1 flex-col items-start gap-0.5 text-left",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email})]}),(0,r.jsx)(eA,{variant:"ghost",size:"sm",className:"h-8 w-8 rounded-full p-0 text-muted-foreground hover:bg-muted",onClick:t=>{t.stopPropagation(),l(e.id),s("teacher-student-details")},children:(0,r.jsx)(eP.A,{className:"h-4 w-4"})})]},e.id))})}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between gap-3",children:[(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:[F.length," selected"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(eA,{variant:"outline",size:"sm",className:"rounded-lg bg-transparent text-xs text-foreground",onClick:H,disabled:z,children:"Close"}),(0,r.jsx)(eA,{size:"sm",className:"rounded-lg bg-primary text-xs text-primary-foreground",onClick:Q,disabled:C||!!_||z,children:z?"Saving...":"Save Students"})]})]})]})})]})}let tX=[{icon:tg.A,label:"Notifications",screen:"notifications"},{icon:eR.A,label:"Privacy & Security",screen:null},{icon:tb.A,label:"Preferences",screen:null},{icon:tj.A,label:"Help & Support",screen:null}];function tZ(){let{userName:e,userEmail:t,teacherSubject:s,navigate:l,authToken:d,clearAuth:i,setRole:o}=ep(),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)([]),[f,p]=(0,a.useState)(t??""),[g,b]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!d)return b("Teacher login is required.");b(null);try{let[t,s,r]=await Promise.all([h(d),A(d),P(d)]);e||(p(t.email),x(s),u(r))}catch(t){e||(t instanceof n?b(t.detail):b("Failed to load profile details."))}})(),()=>{e=!0}},[d]),(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-accent/15",children:(0,r.jsx)(tN.A,{className:"h-10 w-10 text-accent"})}),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full bg-primary",children:(0,r.jsx)(tu.A,{className:"h-4 w-4 text-primary-foreground"})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-foreground",children:e||"Teacher"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s??"Physics"," Teacher"]})]}),(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:m.length}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Classes"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:c?.total_students??0}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Students"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:c?.total_papers??0}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Papers"})]})]})]}),g&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:g}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Profile Details"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(tv.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:f||"-"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(eS.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:s??"Physics"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(tf.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsxs)("span",{className:"text-sm text-foreground",children:[c?.total_students??0," active students"]})]})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1 rounded-2xl border border-border bg-card p-2",children:tX.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>e.screen&&l(e.screen),className:"flex items-center gap-3 rounded-xl px-3 py-3 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(t,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsx)("span",{className:"flex-1 text-left text-sm font-medium text-foreground",children:e.label}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-muted-foreground"})]},e.label)})}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>{i(),o(null),l("auth")},className:"gap-2 rounded-2xl border-destructive/30 bg-transparent py-5 text-destructive hover:bg-destructive/10 hover:text-destructive",children:[(0,r.jsx)(tk.A,{className:"h-4 w-4"}),"Sign Out"]})]})}var t0=s(8459);function t1(){let{teacherSubject:e,authToken:t}=ep(),[s,l]=(0,a.useState)("All"),[d,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!1),[x,m]=(0,a.useState)([]),[u,f]=(0,a.useState)(!0),[h,p]=(0,a.useState)(null),[g,b]=(0,a.useState)(null),[j,N]=(0,a.useState)(0),[v,y]=(0,a.useState)(""),[w,k]=(0,a.useState)("12th"),[A,S]=(0,a.useState)(""),[C,$]=(0,a.useState)(""),[_,P]=(0,a.useState)("60"),[T,E]=(0,a.useState)(!1),[D,R]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!t){p("Teacher login is required."),f(!1);return}f(!0),p(null);try{let s=await M(t);e||m(s)}catch(t){e||(t instanceof n?p(t.detail):p("Failed to load lesson plans."),m([]))}finally{e||f(!1)}})(),()=>{e=!0}},[t,j]);let z=(0,a.useMemo)(()=>x.filter(e=>"All"===s||e.year===s),[x,s]),U=()=>{y(""),S(""),$(""),P("60"),k("12th"),E(!1)},I=async()=>{if(!t||T)return;let e=v.trim(),s=Number(_),r=A.split(",").map(e=>e.trim()).filter(Boolean),a=C.split(",").map(e=>e.trim()).filter(Boolean);if(!e)return void b("Topic is required.");if(!Number.isFinite(s)||s<15||s>180)return void b("Duration must be between 15 and 180.");b(null),E(!0);try{let l=await q(t,{year:w,topic:e,objectives:r,activities:a,duration:s});m(e=>[l,...e]),c(!1),U()}catch(e){e instanceof n?b(e.detail):b("Unable to create lesson plan."),E(!1)}},O=async e=>{if(t&&!D){b(null),R(e);try{await F(t,e),m(t=>t.filter(t=>t.id!==e)),d===e&&i(null)}catch(e){e instanceof n?b(e.detail):b("Unable to delete lesson plan.")}finally{R(null)}}},B=async e=>{if(t&&!D){b(null),R(e.id);try{let s=await L(t,e.id,{status:"published"===e.status?"draft":"published"});m(e=>e.map(e=>e.id===s.id?s:e))}catch(e){e instanceof n?b(e.detail):b("Unable to update lesson plan.")}finally{R(null)}}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Lesson Plans"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e||"Physics"," - ",u?"Loading...":`${z.length} plans`]})]}),(0,r.jsxs)(eA,{onClick:()=>c(!0),className:"gap-1.5 rounded-xl bg-primary text-primary-foreground",size:"sm",children:[(0,r.jsx)(tI.A,{className:"h-4 w-4"}),"New Plan"]})]}),g&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:g}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eX.A,{className:"h-4 w-4 text-muted-foreground"}),["All","11th","12th"].map(e=>(0,r.jsx)("button",{onClick:()=>l(e),className:`rounded-full px-4 py-1.5 text-xs font-medium transition-colors ${s===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"All"===e?"All Years":`${e} Class`},e))]}),o&&(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-4 rounded-2xl border border-primary/30 bg-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Create New Lesson Plan"}),(0,r.jsx)("button",{onClick:()=>{c(!1),U()},className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{className:"text-xs font-medium text-foreground",children:"Topic"}),(0,r.jsx)(eD,{placeholder:"e.g. Newton's Laws of Motion",value:v,onChange:e=>y(e.target.value),className:"rounded-xl border-border bg-background text-sm text-foreground"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{className:"text-xs font-medium text-foreground",children:"Year"}),(0,r.jsx)("div",{className:"flex gap-2",children:["11th","12th"].map(e=>(0,r.jsx)("button",{onClick:()=>k(e),className:`flex-1 rounded-lg py-2 text-xs font-medium transition-colors ${w===e?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:e},e))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{className:"text-xs font-medium text-foreground",children:"Learning Objectives (comma-separated)"}),(0,r.jsx)(eD,{placeholder:"e.g. Understand forces, Apply formulas",value:A,onChange:e=>S(e.target.value),className:"rounded-xl border-border bg-background text-sm text-foreground"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{className:"text-xs font-medium text-foreground",children:"Activities (comma-separated)"}),(0,r.jsx)(eD,{placeholder:"e.g. Lab demo, Problem solving",value:C,onChange:e=>$(e.target.value),className:"rounded-xl border-border bg-background text-sm text-foreground"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(eL,{className:"text-xs font-medium text-foreground",children:"Duration (minutes)"}),(0,r.jsx)(eD,{type:"number",value:_,onChange:e=>P(e.target.value),className:"rounded-xl border-border bg-background text-sm text-foreground",min:"15",max:"180"})]}),(0,r.jsx)(eA,{onClick:I,disabled:T||!v.trim(),className:"w-full rounded-xl bg-primary py-5 text-primary-foreground",children:T?"Creating...":"Create Lesson Plan"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:u?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading lesson plans..."}):h?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:h}),(0,r.jsx)("button",{onClick:()=>N(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===z.length?(0,r.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-8 text-center",children:[(0,r.jsx)(tR.A,{className:"mx-auto h-8 w-8 text-muted-foreground"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"No lesson plans found"})]}):z.map((e,t)=>(0,r.jsxs)("div",{className:"animate-fade-in overflow-hidden rounded-2xl border border-border bg-card",style:{animationDelay:`${60*t}ms`},children:[(0,r.jsxs)("button",{onClick:()=>i(d===e.id?null:e.id),className:"flex w-full items-center gap-4 p-4 text-left",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10",children:(0,r.jsx)(eS.A,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.topic}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[10px] font-medium text-muted-foreground",children:e.year}),(0,r.jsxs)("span",{className:"flex items-center gap-1 text-[11px] text-muted-foreground",children:[(0,r.jsx)(eW.A,{className:"h-3 w-3"}),e.duration," min"]})]})]}),(0,r.jsx)("span",{className:`rounded-full px-2.5 py-1 text-[10px] font-medium ${"published"===e.status?"bg-accent/15 text-accent":"bg-muted text-muted-foreground"}`,children:e.status}),d===e.id?(0,r.jsx)(ts.A,{className:"h-4 w-4 text-muted-foreground"}):(0,r.jsx)(tr.A,{className:"h-4 w-4 text-muted-foreground"})]}),d===e.id&&(0,r.jsx)("div",{className:"animate-fade-in border-t border-border p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsx)("span",{className:"text-[11px] font-semibold text-foreground",children:"Objectives"}),(0,r.jsx)("ul",{className:"flex flex-col gap-1",children:e.objectives.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-2 text-[11px] text-muted-foreground",children:[(0,r.jsx)(eZ.A,{className:"mt-0.5 h-3 w-3 shrink-0 text-accent"}),e]},t))})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsx)("span",{className:"text-[11px] font-semibold text-foreground",children:"Activities"}),(0,r.jsx)("ul",{className:"flex flex-col gap-1",children:e.activities.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-2 text-[11px] text-muted-foreground",children:[(0,r.jsx)(to.A,{className:"mt-0.5 h-3 w-3 shrink-0 text-primary"}),e]},t))})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-1",children:[(0,r.jsx)(eA,{variant:"outline",size:"sm",onClick:()=>B(e),disabled:D===e.id,className:"flex-1 rounded-lg text-xs",children:D===e.id?"Updating...":"published"===e.status?"Unpublish":"Publish"}),(0,r.jsx)(eA,{variant:"outline",size:"sm",onClick:()=>O(e.id),disabled:D===e.id,className:"rounded-lg text-xs text-destructive hover:bg-destructive/10 hover:text-destructive",children:(0,r.jsx)(t0.A,{className:"h-3.5 w-3.5"})})]})]})})]},e.id))})]})}var t2=s(2032);function t5(){let{navigate:e,authToken:t,selectedStudentId:s}=ep(),[l,d]=(0,a.useState)([]),[i,o]=(0,a.useState)(!0),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(new Set);return((0,a.useEffect)(()=>{(async()=>{if(!t||!s)return o(!1);try{let e=await R(t,s);d(e)}catch(e){e instanceof n?x(e.detail):x("Failed to load student details.")}finally{o(!1)}})()},[t,s]),s)?(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>e("teacher-classes"),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Student Performance"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Test history & proctoring logs"})]})]}),i?(0,r.jsx)("div",{className:"flex h-40 items-center justify-center",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-muted border-t-primary"})}):c?(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 p-4 text-sm text-destructive",children:c}):0===l.length?(0,r.jsxs)("div",{className:"flex h-40 flex-col items-center justify-center gap-2 rounded-2xl border border-dashed border-border p-6 text-center",children:[(0,r.jsx)(to.A,{className:"h-8 w-8 text-muted-foreground/50"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No test attempts found for this student."})]}):(0,r.jsx)("div",{className:"flex flex-col gap-3",children:l.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4 shadow-sm transition-all hover:border-primary/20",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-foreground",children:e.test_title}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,r.jsx)("span",{className:"rounded-full bg-muted px-2 py-0.5",children:e.subject}),(0,r.jsx)("span",{children:""}),(0,r.jsx)("span",{children:e.submitted_at?new Date(e.submitted_at).toLocaleDateString():"Unknown Date"})]})]}),(0,r.jsxs)("div",{className:`flex items-center gap-1.5 rounded-lg px-2.5 py-1.5 text-xs font-bold leading-none ${e.score>=80?"bg-emerald-500/10 text-emerald-500":e.score>=50?"bg-warning/10 text-warning":"bg-destructive/10 text-destructive"}`,children:[e.score,"%"]})]}),e.is_suspicious&&(0,r.jsxs)("div",{className:"mt-1 flex items-start gap-2 rounded-xl border border-destructive/20 bg-destructive/5 p-3",children:[(0,r.jsx)(t2.A,{className:"h-4 w-4 shrink-0 text-destructive mt-0.5"}),(0,r.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-destructive",children:"Proctoring Alert"}),(0,r.jsx)("span",{className:"text-xs text-destructive/80",children:e.violation_reason||"Auto-submitted due to suspicious activity."})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-border/50 pt-3",children:[(0,r.jsx)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(to.A,{className:"h-3.5 w-3.5"}),(0,r.jsxs)("span",{children:[e.total_questions," Questions"]})]})}),(0,r.jsxs)(eA,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.attempt_id,void u(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},className:"h-8 gap-1 rounded-lg text-xs text-primary hover:bg-primary/5 hover:text-primary",children:[m.has(e.attempt_id)?"Hide Details":"View Analysis",(0,r.jsx)(tr.A,{className:`h-3.5 w-3.5 transition-transform ${m.has(e.attempt_id)?"rotate-180":""}`})]})]}),m.has(e.attempt_id)&&e.questions&&(0,r.jsx)("div",{className:"animate-slide-down mt-2 flex flex-col gap-3 border-t border-border/50 pt-3",children:e.questions.map((e,t)=>(0,r.jsx)("div",{className:"flex flex-col gap-2 rounded-xl border border-border/50 bg-muted/30 p-3",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"mt-0.5 flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-muted text-[10px] font-bold text-muted-foreground",children:t+1}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.question_text}),(0,r.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:`rounded-lg border px-3 py-2 text-xs ${e.is_correct?"border-emerald-500/20 bg-emerald-500/10 text-emerald-600":"border-destructive/20 bg-destructive/10 text-destructive"}`,children:[(0,r.jsx)("span",{className:"mb-0.5 block font-semibold opacity-70",children:"Student Answer"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:e.selected_option||"Not Answered"}),void 0!==e.time_spent&&(0,r.jsxs)("span",{className:"flex items-center gap-1 rounded-full bg-background/50 px-1.5 py-0.5 text-[10px] font-medium opacity-80 shadow-sm",children:[(0,r.jsx)(eW.A,{className:"h-3 w-3"}),e.time_spent,"s"]})]})]}),!e.is_correct&&(0,r.jsxs)("div",{className:"rounded-lg border border-emerald-500/20 bg-emerald-500/5 px-3 py-2 text-xs text-emerald-600",children:[(0,r.jsx)("span",{className:"mb-0.5 block font-semibold opacity-70",children:"Correct Answer"}),e.correct_option]})]}),e.explanation&&(0,r.jsxs)("div",{className:"mt-1 rounded-lg bg-muted p-2 text-xs text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Explanation: "}),e.explanation]})]})]})},t))})]},e.attempt_id))})]}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background px-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"No student selected."}),(0,r.jsx)(eA,{onClick:()=>e("teacher-classes"),children:"Go Back"})]})})}let t3={paper:{container:"bg-primary/15",icon:to.A,iconClass:"text-primary"},test:{container:"bg-accent/15",icon:eS.A,iconClass:"text-accent"},material:{container:"bg-warning/15",icon:tz.A,iconClass:"text-warning"},achievement:{container:"bg-accent/15",icon:eJ.A,iconClass:"text-accent"},chat:{container:"bg-primary/15",icon:eS.A,iconClass:"text-primary"},feedback:{container:"bg-warning/15",icon:eJ.A,iconClass:"text-warning"},user:{container:"bg-accent/15",icon:tf.A,iconClass:"text-accent"},class:{container:"bg-primary/15",icon:e$.A,iconClass:"text-primary"},plan:{container:"bg-warning/15",icon:eS.A,iconClass:"text-warning"}},t4={container:"bg-muted",icon:to.A,iconClass:"text-muted-foreground"};function t6(){let{userName:e,navigate:t,authToken:s,adminDashboardData:l,setAdminDashboardData:d}=ep(),[i,o]=(0,a.useState)(l||null),[c,x]=(0,a.useState)(!l),[m,u]=(0,a.useState)(null),[f,h]=(0,a.useState)(0);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!s){o(null),u("Admin login is required to view dashboard data."),x(!1);return}x(!0),u(null);try{let t=await p(s);e||(o(t),d(t))}catch(t){e||(o(null),t instanceof n?u(t.detail):u("Failed to load dashboard."))}finally{e||x(!1)}})(),()=>{e=!0}},[s,f]),(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-4",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-1",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Welcome back,"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-foreground text-balance",children:e||"Admin"}),(0,r.jsx)("span",{className:"mt-1 w-fit rounded-full bg-warning/10 px-3 py-1 text-xs font-semibold text-warning",children:"Principal"})]}),c&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading dashboard..."}),!c&&m&&(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:m}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>h(e=>e+1),className:"rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"}),(0,r.jsx)("button",{onClick:()=>t("auth"),className:"rounded-lg border border-border bg-card px-3 py-2 text-xs font-medium text-foreground",children:"Go to Login"})]})]}),!c&&!m&&i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"animate-fade-in grid grid-cols-2 gap-3",style:{animationDelay:"100ms"},children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(e$.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:i.total_students}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Students"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent/15",children:(0,r.jsx)(tf.A,{className:"h-5 w-5 text-accent"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:i.total_teachers}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Teachers"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-warning/15",children:(0,r.jsx)(to.A,{className:"h-5 w-5 text-warning"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-foreground",children:i.active_tests}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Active Tests"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-primary/15",children:(0,r.jsx)(eJ.A,{className:"h-5 w-5 text-primary"})}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-foreground",children:[i.pass_rate,"%"]}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Pass Rate"})]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"200ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Department Performance"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-3",children:i.departments.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[e.teachers," teachers"]})]}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-primary",children:[e.avg_score,"%"]})]}),(0,r.jsx)("div",{className:"h-2.5 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full ${e.avg_score>=80?"bg-accent":e.avg_score>=70?"bg-primary":"bg-warning"}`,style:{width:`${e.avg_score}%`}})})]},e.subject))})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"300ms"},children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsxs)("button",{onClick:()=>t("admin-users"),className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(tf.A,{className:"h-6 w-6 text-primary"}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-foreground",children:"Manage Users"})]}),(0,r.jsxs)("button",{onClick:()=>t("admin-reports"),className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(eC.A,{className:"h-6 w-6 text-accent"}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-foreground",children:"View Reports"})]}),(0,r.jsxs)("button",{onClick:()=>t("admin-content"),className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-4 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(tz.A,{className:"h-6 w-6 text-warning"}),(0,r.jsx)("span",{className:"text-[11px] font-medium text-foreground",children:"Moderate"})]})]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"400ms"},children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground text-balance",children:"Global Exam Settings"}),(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-5",children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-accent/15",children:(0,r.jsx)(eW.A,{className:"h-5 w-5 text-accent"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"JEE Main 2026"}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Sets the deadline for all study plans"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("input",{type:"date",className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-primary",id:"jee-date-input",defaultValue:"2026-06-15"}),(0,r.jsx)("button",{onClick:async()=>{let e=document.getElementById("jee-date-input");if(e&&e.value&&s)try{let t=await et(s,`${e.value}T00:00:00Z`);alert(t.message),h(e=>e+1)}catch(e){alert("Failed to set exam date")}},className:"w-full rounded-lg bg-primary py-2.5 text-sm font-semibold text-primary-foreground shadow-sm transition-transform active:scale-95",children:"Set Date & Sync Plans"})]})]})})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3",style:{animationDelay:"450ms"},children:[(0,r.jsx)("h2",{className:"text-base font-semibold text-foreground",children:"Recent Activity"}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:0===i.recent_activity.length?(0,r.jsx)("div",{className:"rounded-xl border border-border bg-card p-4 text-xs text-muted-foreground",children:"No recent activity yet. Actions from admin, teacher, and student modules will appear here."}):i.recent_activity.map(e=>{let t=t3[e.type]??t4,s=t.icon;return(0,r.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-border bg-card p-3",children:[(0,r.jsx)("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-lg ${t.container}`,children:(0,r.jsx)(s,{className:`h-4 w-4 ${t.iconClass}`})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.text}),(0,r.jsxs)("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[(0,r.jsx)(eW.A,{className:"h-2.5 w-2.5"}),e.time]})]}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-muted-foreground"})]},e.id)})})]})]})]})}var t8=s(4478);let t9=[{icon:tf.A,label:"Manage Users",screen:"admin-users"},{icon:eC.A,label:"Reports",screen:"admin-reports"},{icon:to.A,label:"Content Moderation",screen:"admin-content"}];function t7(){let{userName:e,userEmail:t,authToken:s,navigate:l,clearAuth:d,setRole:i}=ep(),[o,c]=(0,a.useState)(t||""),[x,m]=(0,a.useState)({totalStudents:0,totalTeachers:0,activeTests:0}),[u,f]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!s)return f("Admin login is required.");f(null);try{let[t,r]=await Promise.all([h(s),p(s)]);e||(c(t.email),m({totalStudents:r.total_students,totalTeachers:r.total_teachers,activeTests:r.active_tests}))}catch(t){e||(t instanceof n?f(t.detail):f("Failed to load profile details."))}})(),()=>{e=!0}},[s]),(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[u&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:u}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 rounded-2xl border border-border bg-card p-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-warning/15",children:(0,r.jsx)(tN.A,{className:"h-10 w-10 text-warning"})}),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 flex h-7 w-7 items-center justify-center rounded-full bg-primary",children:(0,r.jsx)(t8.A,{className:"h-4 w-4 text-primary-foreground"})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-foreground",children:e||"Admin"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Principal"})]}),(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:x.totalStudents}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Students"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:x.totalTeachers}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Teachers"})]}),(0,r.jsx)("div",{className:"h-8 w-px bg-border"}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,r.jsx)("span",{className:"text-base font-bold text-foreground",children:x.activeTests}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Active Tests"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Profile Details"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(tv.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:o||t||"--"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(t8.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:"Role: Admin"})]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1 rounded-2xl border border-border bg-card p-2",children:t9.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>l(e.screen),className:"flex items-center gap-3 rounded-xl px-3 py-3 transition-colors hover:bg-muted/50",children:[(0,r.jsx)(t,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsx)("span",{className:"flex-1 text-left text-sm font-medium text-foreground",children:e.label}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-muted-foreground"})]},e.label)})}),(0,r.jsxs)(eA,{variant:"outline",onClick:()=>{d(),i(null),l("auth")},className:"gap-2 rounded-2xl border-destructive/30 bg-transparent py-5 text-destructive hover:bg-destructive/10 hover:text-destructive",children:[(0,r.jsx)(tk.A,{className:"h-4 w-4"}),"Sign Out"]})]})}var se=s(7684),st=s(7577),ss=s(7800);let sr=["Physics","Chemistry","Mathematics"],sa=["11th","12th"],sl={name:"",email:"",password:"",role:"student",subject:"Physics",year:"11th"};function sn(){let{authToken:e}=ep(),[t,s]=(0,a.useState)("all"),[l,d]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(!1),[f,h]=(0,a.useState)([]),[p,N]=(0,a.useState)(!0),[v,y]=(0,a.useState)(null),[w,k]=(0,a.useState)(null),[A,S]=(0,a.useState)(0),[C,$]=(0,a.useState)(null),[_,P]=(0,a.useState)(!1),[T,E]=(0,a.useState)(sl);(0,a.useEffect)(()=>{let e=window.setTimeout(()=>{o(l.trim())},300);return()=>window.clearTimeout(e)},[l]),(0,a.useEffect)(()=>{let s=!1;return(async()=>{if(!e){h([]),N(!1),y("Admin login is required to manage users.");return}N(!0),y(null),k(null);try{let r=await g(e,{role:"all"===t?void 0:t,search:i||void 0,page:1,limit:200});if(!s){let e=r.items.filter(e=>"admin"!==e.role);h(e)}}catch(e){s||(e instanceof n?y(e.detail):y("Failed to load users."),h([]))}finally{s||N(!1)}})(),()=>{s=!0}},[t,e,i,A]);let D=()=>{u(!1),k(null),E(sl)},M=async t=>{if(e&&!C){k(null),$(t.id);try{let s=await j(e,t.id,"active"===t.status?"inactive":"active");h(e=>e.map(e=>e.id===s.id?s:e))}catch(e){e instanceof n?k(e.detail):k("Unable to update user status.")}finally{$(null)}}},q=async()=>{if(!e||_)return;let t=T.name.trim(),s=T.email.trim().toLowerCase();if(!t||!s||!T.password.trim())return void k("Name, email, and password are required.");if(T.password.length<8)return void k("Password must be at least 8 characters.");k(null),P(!0);try{await b(e,{name:t,email:s,password:T.password,role:T.role,..."teacher"===T.role?{subject:T.subject}:{year:T.year}}),D(),S(e=>e+1)}catch(e){e instanceof n?k(e.detail):k("Unable to add user.")}finally{P(!1)}},L=[{label:"All",value:"all",icon:tf.A},{label:"Students",value:"student",icon:e$.A},{label:"Teachers",value:"teacher",icon:eS.A}];return(0,r.jsxs)("div",{className:"flex flex-col gap-4 px-4 py-6",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"User Management"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:p?"Loading users...":`${f.length} user${1===f.length?"":"s"} shown`})]}),(0,r.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center gap-1.5 rounded-xl bg-primary px-3 py-2 text-xs font-medium text-primary-foreground transition-transform active:scale-95",children:[(0,r.jsx)(se.A,{className:"h-3.5 w-3.5"}),"Add User"]})]}),w&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:w}),(0,r.jsxs)("div",{className:"animate-fade-in relative",style:{animationDelay:"50ms"},children:[(0,r.jsx)(ti.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:l,onChange:e=>d(e.target.value),className:"w-full rounded-xl border border-border bg-card py-2.5 pl-9 pr-3 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),(0,r.jsx)("div",{className:"animate-fade-in flex gap-2",style:{animationDelay:"100ms"},children:L.map(e=>{let a=e.icon,l=t===e.value;return(0,r.jsxs)("button",{onClick:()=>s(e.value),className:`flex flex-1 items-center justify-center gap-1.5 rounded-xl py-2.5 text-xs font-medium transition-colors ${l?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:[(0,r.jsx)(a,{className:"h-3.5 w-3.5"}),e.label]},e.value)})}),(0,r.jsx)("div",{className:"animate-fade-in flex flex-col gap-2",style:{animationDelay:"150ms"},children:p?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading users..."}):v?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:v}),(0,r.jsx)("button",{onClick:()=>S(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===f.length?(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-8",children:[(0,r.jsx)(tf.A,{className:"h-8 w-8 text-muted-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No users found"})]}):f.map(e=>{let t=c===e.id;return(0,r.jsxs)("div",{className:"flex flex-col overflow-hidden rounded-xl border border-border bg-card",children:[(0,r.jsxs)("button",{onClick:()=>x(t?null:e.id),className:"flex items-center gap-3 p-3 text-left",children:[(0,r.jsx)("div",{className:`flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold ${"teacher"===e.role?"bg-accent/15 text-accent":"bg-primary/15 text-primary"}`,children:e.name.charAt(0)}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.name}),(0,r.jsx)("span",{className:`rounded-full px-1.5 py-0.5 text-[9px] font-semibold ${"active"===e.status?"bg-accent/15 text-accent":"bg-muted text-muted-foreground"}`,children:e.status})]}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"teacher"===e.role?`${e.subject??"N/A"} Teacher`:`${e.year??"N/A"} Student`})]}),t?(0,r.jsx)(ts.A,{className:"h-4 w-4 text-muted-foreground"}):(0,r.jsx)(tr.A,{className:"h-4 w-4 text-muted-foreground"})]}),t&&(0,r.jsxs)("div",{className:"flex flex-col gap-3 border-t border-border px-3 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,r.jsx)(tv.A,{className:"h-3.5 w-3.5"}),e.email]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Role:"}),(0,r.jsx)("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[10px] font-medium text-foreground capitalize",children:e.role})]}),"student"===e.role&&e.year&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Year:"}),(0,r.jsxs)("span",{className:"rounded-full bg-primary/10 px-2 py-0.5 text-[10px] font-medium text-primary",children:[e.year," Class"]})]}),"teacher"===e.role&&e.subject&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Subject:"}),(0,r.jsx)("span",{className:"rounded-full bg-accent/10 px-2 py-0.5 text-[10px] font-medium text-accent",children:e.subject})]}),(0,r.jsx)("button",{onClick:()=>M(e),disabled:C===e.id,className:`flex items-center gap-2 rounded-lg px-3 py-2 text-xs font-medium transition-colors ${"active"===e.status?"bg-destructive/10 text-destructive":"bg-accent/10 text-accent"}`,children:C===e.id?"Updating...":"active"===e.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(st.A,{className:"h-4 w-4"}),"Deactivate User"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ss.A,{className:"h-4 w-4"}),"Activate User"]})})]})]},e.id)})}),m&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"w-full max-w-lg animate-slide-up rounded-t-3xl bg-card p-5",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-base font-bold text-foreground",children:"Add New User"}),(0,r.jsx)("button",{onClick:D,className:"rounded-lg p-1.5 text-muted-foreground hover:bg-muted",children:(0,r.jsx)(tO.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Full Name",value:T.name,onChange:e=>E(t=>({...t,name:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"}),(0,r.jsx)("input",{type:"email",placeholder:"Email Address",value:T.email,onChange:e=>E(t=>({...t,email:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"}),(0,r.jsx)("input",{type:"password",placeholder:"Password (min 8 chars)",value:T.password,onChange:e=>E(t=>({...t,password:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"}),(0,r.jsxs)("select",{value:T.role,onChange:e=>E(t=>({...t,role:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30",children:[(0,r.jsx)("option",{value:"student",children:"Student"}),(0,r.jsx)("option",{value:"teacher",children:"Teacher"})]}),"teacher"===T.role?(0,r.jsx)("select",{value:T.subject,onChange:e=>E(t=>({...t,subject:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30",children:sr.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}):(0,r.jsx)("select",{value:T.year,onChange:e=>E(t=>({...t,year:e.target.value})),className:"w-full rounded-xl border border-border bg-background px-3 py-2.5 text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30",children:sa.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)("button",{onClick:q,disabled:_,className:"mt-2 w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-transform active:scale-[0.98]",children:_?"Adding User...":"Add User"})]})]})})]})}var sd=s(4514);function si(){let{authToken:e}=ep(),[t,s]=(0,a.useState)("all"),[l,d]=(0,a.useState)("All"),[i,o]=(0,a.useState)([]),[c,x]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[f,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(0),[b,j]=(0,a.useState)(null),[y,w]=(0,a.useState)([]),k=e=>w(t=>[...t,`${new Date().toISOString().split("T")[1]} ${e}`]);(0,a.useEffect)(()=>{let s=!1;return(async()=>{if(k("Starting loadItems"),!e){k("No auth token"),o([]),x(!1),u("Admin login is required to moderate content.");return}k(`Token present: ${e.substring(0,10)}...`),x(!0),u(null);try{k("Calling listAdminContentItems...");let r=await N(e,{status:"all"===t?void 0:t,subject:"All"===l?void 0:l,page:1,limit:200});s?k("Cancelled after success"):(k(`Success! Got ${r.items.length} items`),o(r.items))}catch(e){s||(k(`Error: ${e.message||e}`),e.detail&&k(`Detail: ${e.detail}`),o([]),e instanceof n?u(e.detail):u("Failed to load content items."))}finally{s||(k("Finally block - loading false"),x(!1))}})(),()=>{s=!0}},[e,p,t,l]);let A=async(s,r)=>{if(e&&!b){h(null),j(s);try{let a=await v(e,s,r);"pending"===t?o(e=>e.filter(e=>e.id!==s)):o(e=>e.map(e=>e.id===a.id?a:e))}catch(e){e instanceof n?h(e.detail):h("Unable to update content status.")}finally{j(null)}}},S=i.filter(e=>"pending"===e.status).length;return(0,r.jsxs)("div",{className:"flex flex-col gap-4 px-4 py-6",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Content Moderation"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[S," item",1!==S?"s":""," pending review"]})]}),f&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:f}),(0,r.jsx)("div",{className:"animate-fade-in flex gap-2 overflow-x-auto",style:{animationDelay:"50ms"},children:[{label:"All",value:"all"},{label:"Pending",value:"pending"},{label:"Approved",value:"approved"},{label:"Rejected",value:"rejected"}].map(e=>(0,r.jsxs)("button",{onClick:()=>s(e.value),className:`flex shrink-0 items-center gap-1 rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${t===e.value?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:["pending"===e.value&&(0,r.jsx)(eW.A,{className:"h-3 w-3"}),"approved"===e.value&&(0,r.jsx)(eZ.A,{className:"h-3 w-3"}),"rejected"===e.value&&(0,r.jsx)(e7.A,{className:"h-3 w-3"}),e.label]},e.value))}),(0,r.jsxs)("div",{className:"animate-fade-in flex gap-2 overflow-x-auto",style:{animationDelay:"100ms"},children:[(0,r.jsx)(eX.A,{className:"mt-1 h-3.5 w-3.5 shrink-0 text-muted-foreground"}),["All","Physics","Chemistry","Mathematics"].map(e=>(0,r.jsx)("button",{onClick:()=>d(e),className:`shrink-0 rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${l===e?"bg-accent/15 text-accent":"border border-border bg-card text-muted-foreground"}`,children:e},e))]}),(0,r.jsx)("div",{className:"animate-fade-in flex flex-col gap-2",style:{animationDelay:"150ms"},children:c?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading content items..."}):m?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:m}),(0,r.jsx)("button",{onClick:()=>g(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):0===i.length?(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-2xl border border-border bg-card p-8",children:[(0,r.jsx)(tz.A,{className:"h-8 w-8 text-muted-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No content items found"})]}):i.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-xl border border-border bg-card p-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:`flex h-9 w-9 shrink-0 items-center justify-center rounded-lg ${"pending"===e.status?"bg-warning/15":"approved"===e.status?"bg-accent/15":"bg-destructive/15"}`,children:(0,r.jsx)(to.A,{className:`h-4 w-4 ${"pending"===e.status?"text-warning":"approved"===e.status?"text-accent":"text-destructive"}`})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:["by ",e.uploaded_by]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:e.date})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"rounded-full bg-muted px-2 py-0.5 text-[9px] font-medium text-foreground",children:e.subject}),(0,r.jsx)("span",{className:`rounded-full px-2 py-0.5 text-[9px] font-semibold capitalize ${"pending"===e.status?"bg-warning/15 text-warning":"approved"===e.status?"bg-accent/15 text-accent":"bg-destructive/15 text-destructive"}`,children:e.status})]})]})]}),"pending"===e.status&&(0,r.jsxs)("div",{className:"flex gap-2 border-t border-border pt-2",children:[(0,r.jsxs)("button",{onClick:()=>A(e.id,"approved"),disabled:b===e.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-lg bg-accent/10 py-2 text-xs font-medium text-accent transition-colors hover:bg-accent/20",children:[(0,r.jsx)(sd.A,{className:"h-3.5 w-3.5"}),b===e.id?"Updating...":"Approve"]}),(0,r.jsxs)("button",{onClick:()=>A(e.id,"rejected"),disabled:b===e.id,className:"flex flex-1 items-center justify-center gap-1.5 rounded-lg bg-destructive/10 py-2 text-xs font-medium text-destructive transition-colors hover:bg-destructive/20",children:[(0,r.jsx)(tO.A,{className:"h-3.5 w-3.5"}),b===e.id?"Updating...":"Reject"]})]})]},e.id))}),(0,r.jsx)("div",{className:"mt-4 max-h-40 overflow-y-auto rounded bg-black/80 p-2 text-[10px] font-mono text-green-400",children:y.map((e,t)=>(0,r.jsx)("div",{children:e},t))})]})}var so=s(9372);function sc(){let{authToken:e}=ep(),[t,s]=(0,a.useState)("analytics"),[l,d]=(0,a.useState)(!1),[i,o]=(0,a.useState)(null),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),[f,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),[b,j]=(0,a.useState)(!1),[N,v]=(0,a.useState)(0);(0,a.useEffect)(()=>{let t=!1;return(async()=>{if(!e){o(null),x(null),u(!1),h("Admin login is required to view reports.");return}u(!0),h(null);try{let[s,r]=await Promise.all([y(e),w(e)]);t||(o(s),x(r))}catch(e){t||(o(null),x(null),e instanceof n?h(e.detail):h("Failed to load reports."))}finally{t||u(!1)}})(),()=>{t=!0}},[e,N]);let A=(0,a.useMemo)(()=>"analytics"===t?i?.monthly_usage??[]:c?.monthly_usage??[],[t,i?.monthly_usage,c?.monthly_usage]),S=(0,a.useMemo)(()=>0===A.length?1:Math.max(...A.map(e=>e.tests),1),[A]),C=async()=>{if(e&&!b){g(null),j(!0);try{let{blob:s,filename:r}=await k(e,t),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download=r,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(a),d(!0),window.setTimeout(()=>d(!1),2e3)}catch(e){e instanceof n?g(e.detail):g("Unable to export report.")}finally{j(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col gap-4 px-4 py-6",children:[(0,r.jsxs)("div",{className:"animate-fade-in flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Reports"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Institution analytics & billing"})]}),(0,r.jsxs)("button",{onClick:C,disabled:b||m,className:"flex items-center gap-1.5 rounded-xl border border-border bg-card px-3 py-2 text-xs font-medium text-foreground transition-transform active:scale-95 disabled:opacity-60",children:[(0,r.jsx)(tc.A,{className:"h-3.5 w-3.5"}),b?"Exporting...":"Export"]})]}),p&&(0,r.jsx)("div",{className:"rounded-xl border border-destructive/30 bg-destructive/10 px-3 py-2 text-xs text-destructive",children:p}),(0,r.jsxs)("div",{className:"animate-fade-in flex gap-2",style:{animationDelay:"50ms"},children:[(0,r.jsxs)("button",{onClick:()=>s("analytics"),className:`flex flex-1 items-center justify-center gap-1.5 rounded-xl py-2.5 text-xs font-medium transition-colors ${"analytics"===t?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:[(0,r.jsx)(eC.A,{className:"h-3.5 w-3.5"}),"Analytics"]}),(0,r.jsxs)("button",{onClick:()=>s("billing"),className:`flex flex-1 items-center justify-center gap-1.5 rounded-xl py-2.5 text-xs font-medium transition-colors ${"billing"===t?"bg-primary text-primary-foreground":"border border-border bg-card text-muted-foreground"}`,children:[(0,r.jsx)(so.A,{className:"h-3.5 w-3.5"}),"Billing"]})]}),m?(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:"Loading reports..."}):f?(0,r.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-destructive",children:f}),(0,r.jsx)("button",{onClick:()=>v(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}):"analytics"===t&&i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"animate-fade-in grid grid-cols-2 gap-3",style:{animationDelay:"100ms"},children:[(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(e$.A,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-xl font-bold text-foreground",children:i.total_students}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Total Students"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(tf.A,{className:"h-5 w-5 text-accent"}),(0,r.jsx)("span",{className:"text-xl font-bold text-foreground",children:i.total_teachers}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Total Teachers"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(to.A,{className:"h-5 w-5 text-warning"}),(0,r.jsx)("span",{className:"text-xl font-bold text-foreground",children:i.active_tests}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Active Tests"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-1 rounded-2xl border border-border bg-card p-4",children:[(0,r.jsx)(eJ.A,{className:"h-5 w-5 text-primary"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-foreground",children:[i.pass_rate,"%"]}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Pass Rate"})]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"150ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Department Breakdown"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4",children:i.departments.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.subject}),(0,r.jsxs)("span",{className:"text-xs font-semibold text-primary",children:[e.avg_score,"% avg"]})]}),(0,r.jsx)("div",{className:"h-3 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full transition-all duration-500 ${e.avg_score>=80?"bg-accent":e.avg_score>=70?"bg-primary":"bg-warning"}`,style:{width:`${e.avg_score}%`}})}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-[10px] text-muted-foreground",children:[(0,r.jsxs)("span",{children:[e.teachers," teachers"]}),(0,r.jsxs)("span",{children:[e.students," students"]})]})]},e.subject))})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"200ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eJ.A,{className:"h-4 w-4 text-accent"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Monthly Test Activity"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:i.monthly_usage.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"w-8 text-[11px] font-medium text-muted-foreground",children:e.month}),(0,r.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:"h-full rounded-full bg-primary",style:{width:`${e.tests/S*100}%`}})})}),(0,r.jsx)("span",{className:"w-8 text-right text-[10px] font-medium text-foreground",children:e.tests})]})]},e.month))}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Tests administered per month"})]})]}):c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-4 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"100ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(so.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Subscription"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Plan"}),(0,r.jsx)("span",{className:"rounded-full bg-primary/10 px-2 py-0.5 text-xs font-semibold text-primary",children:c.plan})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Students Used"}),(0,r.jsxs)("span",{className:"text-xs font-medium text-foreground",children:[c.students_used," / ",c.students_allowed]})]}),(0,r.jsx)("div",{className:"h-2.5 w-full overflow-hidden rounded-full bg-muted",children:(0,r.jsx)("div",{className:`h-full rounded-full ${c.students_allowed>0&&c.students_used/c.students_allowed>.9?"bg-warning":"bg-primary"}`,style:{width:`${c.students_allowed>0?c.students_used/c.students_allowed*100:0}%`}})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Renewal Date"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(tw.A,{className:"h-3 w-3 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:c.renewal_date})]})]})]})]}),(0,r.jsxs)("div",{className:"animate-fade-in flex flex-col gap-3 rounded-2xl border border-border bg-card p-4",style:{animationDelay:"150ms"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4 text-accent"}),(0,r.jsx)("h2",{className:"text-sm font-semibold text-foreground",children:"Usage Breakdown"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:c.monthly_usage.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 px-3 py-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-foreground",children:e.month}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(to.A,{className:"h-3 w-3 text-primary"}),(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[e.tests," tests"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(to.A,{className:"h-3 w-3 text-accent"}),(0,r.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[e.papers," papers"]})]})]})]},e.month))})]}),(0,r.jsxs)("button",{className:"animate-fade-in flex items-center justify-between rounded-2xl border border-primary/20 bg-primary/5 p-4 text-left transition-colors hover:bg-primary/10",style:{animationDelay:"200ms"},children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Need more capacity?"}),(0,r.jsx)("span",{className:"text-[11px] text-muted-foreground",children:"Upgrade to support more students and features"})]}),(0,r.jsx)(eP.A,{className:"h-4 w-4 text-primary"})]})]}):null,l&&(0,r.jsx)("div",{className:"fixed bottom-28 left-1/2 z-50 -translate-x-1/2 rounded-xl bg-foreground px-4 py-2.5 shadow-lg",children:(0,r.jsx)("span",{className:"text-xs font-medium text-background",children:"Report export started"})})]})}let sx={test:to.A,result:e9.A,streak:eH.A,material:eS.A},sm={test:"bg-primary/15 text-primary",result:"bg-warning/15 text-warning",streak:"bg-accent/15 text-accent",material:"bg-primary/15 text-primary"};function su(){let{navigate:e,role:t,authToken:s}=ep(),[l,d]=(0,a.useState)([]),[i,o]=(0,a.useState)(!0),[c,x]=(0,a.useState)(null),[m,u]=(0,a.useState)(0),[f,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!s){x("Login is required."),o(!1);return}o(!0),x(null);try{let t=await X(s);e||d(t)}catch(t){e||(t instanceof n?x(t.detail):x("Failed to load notifications."),d([]))}finally{e||o(!1)}})(),()=>{e=!0}},[s,m]);let p=(0,a.useMemo)(()=>l.filter(e=>!e.read).length,[l]),g=async e=>{if(s&&!e.read)try{let t=await Z(s,e.id,!0);d(e=>e.map(e=>e.id===t.id?t:e))}catch{}},b=async()=>{if(s&&0!==p&&!f){h(!0);try{await ee(s),d(e=>e.map(e=>({...e,read:!0})))}catch(e){e instanceof n?x(e.detail):x("Unable to mark all notifications as read.")}finally{h(!1)}}};return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-4 py-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>{e("teacher"===t?"teacher-home":"student-home")},className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"Notifications"}),(0,r.jsx)("div",{className:"ml-auto flex h-6 items-center rounded-full bg-primary/15 px-2.5",children:(0,r.jsxs)("span",{className:"text-[11px] font-medium text-primary",children:[p," new"]})}),(0,r.jsx)("button",{onClick:()=>{b()},className:"rounded-full border border-border px-2.5 py-1 text-[11px] font-medium text-muted-foreground hover:bg-muted disabled:opacity-50",disabled:0===p||f,children:f?"Updating...":"Mark all read"})]}),c&&(0,r.jsxs)("div",{className:"flex flex-col gap-2 rounded-2xl border border-destructive/30 bg-destructive/10 p-4",children:[(0,r.jsx)("p",{className:"text-xs text-destructive",children:c}),(0,r.jsx)("button",{onClick:()=>u(e=>e+1),className:"w-fit rounded-lg bg-primary px-3 py-2 text-xs font-medium text-primary-foreground",children:"Retry"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[i&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-center text-sm text-muted-foreground",children:"Loading notifications..."}),!i&&0===l.length&&(0,r.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-center text-sm text-muted-foreground",children:"No notifications available."}),!i&&l.map((e,t)=>{let s=sx[e.type]||tg.A,a=sm[e.type]||"bg-muted text-muted-foreground";return(0,r.jsxs)("button",{onClick:()=>{g(e)},className:`animate-fade-in flex items-start gap-3 rounded-2xl border p-4 transition-colors ${e.read?"border-border bg-card":"border-primary/20 bg-primary/5"}`,style:{animationDelay:`${80*t}ms`},children:[(0,r.jsx)("div",{className:`flex h-10 w-10 shrink-0 items-center justify-center rounded-xl ${a}`,children:(0,r.jsx)(s,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:e.title}),!e.read&&(0,r.jsx)("div",{className:"mt-1.5 h-2 w-2 rounded-full bg-primary"})]}),(0,r.jsx)("p",{className:"text-xs leading-relaxed text-muted-foreground",children:e.message}),(0,r.jsx)("span",{className:"text-[10px] text-muted-foreground/70",children:function(e){let t=new Date(e).getTime();if(Number.isNaN(t))return"Unknown";let s=Math.max(0,Math.floor((Date.now()-t)/1e3));if(s<60)return"Just now";let r=Math.floor(s/60);if(r<60)return`${r}m ago`;let a=Math.floor(r/60);if(a<24)return`${a}h ago`;let l=Math.floor(a/24);return`${l}d ago`}(e.created_at)})]})]},e.id)})]})]})}let sf=["Explain Newton's laws of motion","How to solve quadratic equations?","What is Le Chatelier's principle?","Tips for time management in JEE","What questions can be asked on photons in JEE?"],sh=["Give me 5 practice questions from this topic.","Now give answer key only.","Show common mistakes and traps for this topic."];function sp(){let{navigate:e,role:t,authToken:s}=ep(),[l,d]=(0,a.useState)([]),[i,o]=(0,a.useState)(null),[c,x]=(0,a.useState)([]),[m,u]=(0,a.useState)(""),[f,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[b,j]=(0,a.useState)(!1),N=(0,a.useRef)(null);(0,a.useEffect)(()=>{N.current?.scrollIntoView({behavior:"smooth"})},[c,f]),(0,a.useEffect)(()=>{s&&"student"===t&&ed(s).then(d).catch(console.error)},[s,t]);let v=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(!s||!i)return void x([]);if(v.current){v.current=!1;return}ei(s,i).then(e=>{x(e.map(e=>({id:e.id,role:e.role,content:e.content,isStreaming:!1})))}).catch(console.error)},[i,s]);let y=()=>{o(null),x([]),u(""),g(null),h(!1),j(!1)},w=async(e,t)=>{if(e.stopPropagation(),s&&confirm("Are you sure you want to delete this chat?"))try{await eo(s,t),d(e=>e.filter(e=>e.id!==t)),i===t&&y()}catch(e){console.error("Failed to delete session",e)}},k=async e=>{let r=(e||m).trim();if(!r||f)return;if(!s)return void g("Login is required to use AI chat.");let a={id:Date.now().toString(),role:"user",content:r};x(e=>[...e,a]),u(""),h(!0),g(null);let l=(Date.now()+1).toString(),p={id:l,role:"ai",content:"",isStreaming:!0};x(e=>[...e,p]);try{let e=i;if(!e){let t=r.slice(0,30)+(r.length>30?"...":""),a=await en(s,t);e=a.id,v.current=!0,o(e),d(e=>[a,...e])}let a="student"===t?function(e){if(0===e.length)return;let t=e.slice(-6).map(e=>`${"user"===e.role?"Student":"Tutor"}: ${e.content.replace(/\s+/g," ").trim()}`).join("\n").trim();if(t)return t.length>1800?t.slice(t.length-1800):t}(c):void 0,n="student"===t?{query:r,context:a}:{query:r};await ec(s,"student"===t?"/student/doubts/ask":"/student/chat/ask",n,e=>{x(t=>t.map(t=>t.id===l?{...t,content:t.content+e}:t))},e),x(e=>e.map(e=>e.id===l?{...e,isStreaming:!1}:e)),ed(s).then(d).catch(console.error)}catch(t){console.error("Chat Error:",t);let e="I could not answer right now. Please try again.";t instanceof n?e=t.detail:t instanceof Error&&(e=t.message),g(e),x(e=>e.map(e=>e.id===l?{...e,content:"I could not fetch a response. Please retry in a moment.",isStreaming:!1}:e))}finally{h(!1)}},A=()=>{e("teacher"===t?"teacher-home":"student-home")};return(0,r.jsxs)("div",{className:"flex h-screen w-full overflow-hidden bg-background/50",children:[(0,r.jsx)("div",{className:"fixed inset-0 -z-10 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-primary/20 via-background to-background blur-3xl"}),(0,r.jsx)("div",{className:`fixed inset-y-0 left-0 z-50 w-64 transform border-r border-border/50 bg-background/95 backdrop-blur-xl transition-transform duration-300 md:relative md:translate-x-0 ${b?"translate-x-0":"-translate-x-full"}`,children:(0,r.jsxs)("div",{className:"flex h-full flex-col p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider",children:"History"}),(0,r.jsx)(eA,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>j(!1),children:(0,r.jsx)(eF.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)(eA,{onClick:y,className:"mb-4 w-full justify-start gap-2",variant:"outline",children:[(0,r.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-primary/10",children:(0,r.jsx)("span",{className:"text-xs font-bold text-primary",children:"+"})}),"New Chat"]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto space-y-1",children:l.map(e=>(0,r.jsxs)("div",{className:`group flex items-center justify-between w-full rounded-lg px-3 py-2 text-sm transition-colors ${i===e.id?"bg-primary/10 text-primary font-medium":"text-muted-foreground hover:bg-muted/50 hover:text-foreground"}`,children:[(0,r.jsx)("button",{onClick:()=>{o(e.id),j(!1)},className:"flex-1 truncate text-left",children:e.title}),(0,r.jsx)("button",{onClick:t=>w(t,e.id),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-destructive/10 hover:text-destructive rounded transition-all",title:"Delete Chat",children:(0,r.jsx)(t0.A,{className:"h-3.5 w-3.5"})})]},e.id))})]})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col h-full relative",children:[(0,r.jsxs)("header",{className:"sticky top-0 z-40 flex items-center justify-between border-b border-border/50 bg-background/80 px-4 pb-3 pt-[calc(0.5rem+var(--safe-area-inset-top))] backdrop-blur-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("button",{onClick:()=>j(!b),className:"md:hidden flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted/50 transition-colors",children:[(0,r.jsx)("span",{className:"sr-only",children:"Toggle History"}),(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),(0,r.jsx)("button",{onClick:A,className:"hidden md:flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground hover:bg-muted/50 transition-colors","aria-label":"Go back",children:(0,r.jsx)(eF.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-primary to-primary/70 shadow-lg shadow-primary/20",children:(0,r.jsx)(eY.A,{className:"h-5 w-5 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:"AI Tutor (JEE)"}),(0,r.jsx)("span",{className:"text-[10px] uppercase tracking-wider text-muted-foreground",children:f?(0,r.jsx)("span",{className:"animate-pulse text-primary",children:"Thinking..."}):"Online"})]})]})]}),(0,r.jsx)(eA,{variant:"ghost",size:"sm",onClick:A,className:"md:hidden rounded-full text-muted-foreground hover:bg-muted/50 hover:text-foreground",children:"Exit"})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 pb-32",children:null===i&&0===c.length?(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-8 animate-in fade-in zoom-in duration-500",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute -inset-4 rounded-full bg-primary/20 blur-xl animate-pulse"}),(0,r.jsx)("div",{className:"relative flex h-20 w-20 items-center justify-center rounded-3xl bg-gradient-to-br from-primary to-violet-600 shadow-xl shadow-primary/30",children:(0,r.jsx)(eY.A,{className:"h-10 w-10 text-white"})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold tracking-tight text-foreground",children:"Hey, I'm your AI Tutor!"}),(0,r.jsx)("p",{className:"max-w-xs text-sm text-muted-foreground leading-relaxed",children:"Ask me about JEE concepts, solve math problems, or get study strategies."})]}),(0,r.jsx)("div",{className:"grid w-full max-w-sm gap-3",children:sf.map((e,t)=>(0,r.jsxs)("button",{onClick:()=>{k(e)},className:"group relative overflow-hidden rounded-2xl border border-border/50 bg-card/50 px-5 py-4 text-left text-sm text-foreground shadow-sm transition-all hover:border-primary/50 hover:shadow-md hover:bg-card",style:{animationDelay:`${100*t}ms`},children:[(0,r.jsx)("span",{className:"relative z-10",children:e}),(0,r.jsx)("div",{className:"absolute inset-0 bg-primary/5 opacity-0 transition-opacity group-hover:opacity-100"})]},e))})]}):(0,r.jsxs)("div",{className:"flex flex-col gap-6 max-w-3xl mx-auto",children:[c.map(e=>(0,r.jsx)("div",{className:`flex w-full ${"user"===e.role?"justify-end":"justify-start"} animate-in slide-in-from-bottom-2 duration-300`,children:(0,r.jsxs)("div",{className:`flex gap-3 max-w-[85%] ${"user"===e.role?"flex-row-reverse":"flex-row"}`,children:[(0,r.jsx)("div",{className:`mt-1 flex h-8 w-8 shrink-0 items-center justify-center rounded-full shadow-sm ${"ai"===e.role?"bg-gradient-to-br from-primary to-violet-600":"bg-muted"}`,children:"ai"===e.role?(0,r.jsx)(eY.A,{className:"h-4 w-4 text-white"}):(0,r.jsx)(tN.A,{className:"h-4 w-4 text-foreground/70"})}),(0,r.jsx)("div",{className:`rounded-2xl px-5 py-3.5 shadow-sm text-sm leading-7 ${"user"===e.role?"bg-primary text-primary-foreground rounded-tr-none":"bg-card/80 backdrop-blur-sm border border-border/50 text-foreground rounded-tl-none"}`,children:(0,r.jsxs)("p",{className:"whitespace-pre-line",children:[e.content,e.isStreaming&&(0,r.jsx)("span",{className:"ml-1 inline-block h-4 w-1.5 align-middle bg-primary animate-pulse"})]})})]})},e.id)),c.length>0&&"ai"===c[c.length-1].role&&!f&&!c[c.length-1].isStreaming&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2 pl-12 animate-in fade-in duration-500",children:sh.map(e=>(0,r.jsx)("button",{onClick:()=>{k(e)},className:"rounded-full border border-primary/20 bg-primary/5 px-4 py-1.5 text-xs font-medium text-primary transition-colors hover:bg-primary/10",children:e},e))}),p&&(0,r.jsx)("div",{className:"mx-auto rounded-xl border border-destructive/30 bg-destructive/10 px-4 py-3 text-sm text-destructive shadow-sm animate-in fade-in slide-in-from-top-2",children:p}),(0,r.jsx)("div",{ref:N})]})}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-background via-background/90 to-transparent",children:(0,r.jsx)("div",{className:"mx-auto max-w-3xl",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k()},className:"flex items-center gap-2 rounded-3xl border border-border/50 bg-background/80 p-2 shadow-xl shadow-primary/5 backdrop-blur-2xl transition-all focus-within:border-primary/50 focus-within:shadow-2xl focus-within:shadow-primary/10",children:[(0,r.jsx)(eD,{value:m,onChange:e=>u(e.target.value),placeholder:"Ask detailed JEE doubts...",className:"flex-1 border-0 bg-transparent px-4 py-2 text-base placeholder:text-muted-foreground focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,r.jsx)(eA,{type:"submit",disabled:!m.trim()||f,className:"h-10 w-10 shrink-0 rounded-full bg-primary p-0 text-primary-foreground shadow-lg transition-transform hover:scale-105 disabled:opacity-50 disabled:hover:scale-100",children:f?(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,r.jsx)(t_.A,{className:"h-5 w-5 ml-0.5"})})]})})})]})]})}var sg=s(460),sb=s(1900),sj=s(6999),sN=s(4338);function sv(){let{navigate:e,role:t,authToken:s,screen:l}=ep(),{theme:n,setTheme:d}=(0,sg.D)(),[i,o]=(0,a.useState)(0);return(0,a.useEffect)(()=>{let e=!1;return(async()=>{if(!s||"admin"===t||!t)return o(0);try{let t=await X(s);e||o(t.filter(e=>!e.read).length)}catch{e||o(0)}})(),()=>{e=!0}},[s,t,l]),(0,r.jsxs)("header",{className:"sticky top-0 z-40 flex items-center justify-between border-b border-border bg-card/95 px-4 pb-3 pt-[calc(0.75rem+var(--safe-area-inset-top))] backdrop-blur-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary",children:(0,r.jsx)(eg.A,{className:"h-4 w-4 text-primary-foreground"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm font-bold text-foreground",children:"JPM"}),"admin"===t&&(0,r.jsx)("span",{className:"text-[10px] font-medium text-warning",children:"Principal"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>{"admin"===t?e("admin-users"):"teacher"===t?e("teacher-tests"):e("student-tests")},className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground transition-colors hover:bg-muted hover:text-foreground","aria-label":"Search",children:(0,r.jsx)(ti.A,{className:"h-5 w-5"})}),"admin"!==t&&(0,r.jsxs)("button",{onClick:()=>e("notifications"),className:"relative flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground transition-colors hover:bg-muted hover:text-foreground","aria-label":`Notifications, ${i} unread`,children:[(0,r.jsx)(tg.A,{className:"h-5 w-5"}),i>0&&(0,r.jsx)("span",{className:"absolute right-2 top-2 flex h-4 w-4 items-center justify-center rounded-full bg-destructive text-[10px] font-bold text-destructive-foreground",children:i})]}),(0,r.jsx)("button",{onClick:()=>d("dark"===n?"light":"dark"),className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground transition-colors hover:bg-muted hover:text-foreground","aria-label":"Toggle theme",children:"dark"===n?(0,r.jsx)(sb.A,{className:"h-5 w-5"}):(0,r.jsx)(sj.A,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>{"teacher"===t?e("teacher-profile"):"admin"===t?e("admin-profile"):e("student-profile")},className:"flex h-10 w-10 items-center justify-center rounded-xl text-muted-foreground transition-colors hover:bg-muted hover:text-foreground","aria-label":"Profile",children:(0,r.jsx)(sN.A,{className:"h-5 w-5"})})]})]})}var sy=s(6614),sw=s(8401);let sk=[{icon:sy.A,label:"Home",screen:"student-home"},{icon:to.A,label:"Tests",screen:"student-tests"},{icon:eS.A,label:"Library",screen:"student-library"},{icon:eJ.A,label:"Progress",screen:"student-progress"}],sA=[{icon:sy.A,label:"Home",screen:"teacher-home"},{icon:to.A,label:"Papers",screen:"teacher-tests"},{icon:eS.A,label:"Library",screen:"teacher-library"},{icon:tf.A,label:"Classes",screen:"teacher-classes"}],sS=[{icon:sw.A,label:"Dashboard",screen:"admin-dashboard"},{icon:tf.A,label:"Users",screen:"admin-users"},{icon:tz.A,label:"Content",screen:"admin-content"},{icon:eC.A,label:"Reports",screen:"admin-reports"}];function sC(){let{screen:e,navigate:t,role:s}=ep();if("admin"===s)return(0,r.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 border-t border-border bg-card/95 backdrop-blur-xl",role:"navigation","aria-label":"Main navigation",children:(0,r.jsx)("div",{className:"mx-auto grid max-w-lg grid-cols-4 pb-[calc(1.25rem+var(--safe-area-inset-bottom))] pt-2",children:sS.map(s=>{let a=s.icon,l=e===s.screen;return(0,r.jsxs)("button",{onClick:()=>t(s.screen),className:"flex flex-col items-center justify-end gap-1 py-1","aria-label":s.label,"aria-current":l?"page":void 0,children:[(0,r.jsx)(a,{className:`h-5 w-5 transition-colors ${l?"text-primary":"text-muted-foreground"}`}),(0,r.jsx)("span",{className:`text-[10px] font-medium ${l?"text-primary":"text-muted-foreground"}`,children:s.label})]},s.screen)})})});let a="teacher"===s?sA:sk;return(0,r.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 border-t border-border bg-card/95 backdrop-blur-xl",role:"navigation","aria-label":"Main navigation",children:(0,r.jsxs)("div",{className:"relative mx-auto grid max-w-lg grid-cols-5 pb-[calc(1.25rem+var(--safe-area-inset-bottom))] pt-2",children:[a.slice(0,2).map(s=>{let a=s.icon,l=e===s.screen;return(0,r.jsxs)("button",{onClick:()=>t(s.screen),className:"flex flex-col items-center justify-end gap-1 py-1","aria-label":s.label,"aria-current":l?"page":void 0,children:[(0,r.jsx)(a,{className:`h-5 w-5 transition-colors ${l?"text-primary":"text-muted-foreground"}`}),(0,r.jsx)("span",{className:`text-[10px] font-medium ${l?"text-primary":"text-muted-foreground"}`,children:s.label})]},s.screen)}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-end",children:[(0,r.jsx)("button",{onClick:()=>{"teacher"===s?t("teacher-paper-generator"):t("student-tests")},className:"-mt-6 flex h-14 w-14 items-center justify-center rounded-2xl bg-primary shadow-lg shadow-primary/30 transition-transform active:scale-95","aria-label":"teacher"===s?"Generate Paper":"Start Test",children:"teacher"===s?(0,r.jsx)(eY.A,{className:"h-6 w-6 text-primary-foreground"}):(0,r.jsx)(tI.A,{className:"h-6 w-6 text-primary-foreground"})}),(0,r.jsx)("span",{className:"mt-1 text-[10px] font-medium text-primary",children:"teacher"===s?"Generate":"Test"})]}),a.slice(2).map(s=>{let a=s.icon,l=e===s.screen;return(0,r.jsxs)("button",{onClick:()=>t(s.screen),className:"flex flex-col items-center justify-end gap-1 py-1","aria-label":s.label,"aria-current":l?"page":void 0,children:[(0,r.jsx)(a,{className:`h-5 w-5 transition-colors ${l?"text-primary":"text-muted-foreground"}`}),(0,r.jsx)("span",{className:`text-[10px] font-medium ${l?"text-primary":"text-muted-foreground"}`,children:s.label})]},s.screen)})]})})}function s$(){let{screen:e}=ep(),t=["splash","onboarding","auth","student-test-active","ai-chat"].includes(e),s=()=>{switch(e){case"splash":return(0,r.jsx)(eb,{});case"onboarding":return(0,r.jsx)(eE,{});case"auth":return(0,r.jsx)(eI,{});case"student-home":default:return(0,r.jsx)(eK,{});case"student-tests":return(0,r.jsx)(e2,{});case"student-test-active":return(0,r.jsx)(e6,{});case"student-results":return(0,r.jsx)(tn,{});case"student-library":return(0,r.jsx)(tm,{});case"student-progress":return(0,r.jsx)(tp,{});case"student-study-plan":return(0,r.jsx)(tM,{});case"student-profile":return(0,r.jsx)(tS,{});case"student-feedback":return(0,r.jsx)(tP,{});case"teacher-home":return(0,r.jsx)(tU,{});case"teacher-tests":return(0,r.jsx)(tB,{});case"teacher-paper-generator":return(0,r.jsx)(tJ,{});case"teacher-library":case"teacher-upload":return(0,r.jsx)(tY,{});case"teacher-classes":return(0,r.jsx)(tK,{});case"teacher-profile":return(0,r.jsx)(tZ,{});case"teacher-lesson-plans":return(0,r.jsx)(t1,{});case"teacher-student-details":return(0,r.jsx)(t5,{});case"admin-dashboard":return(0,r.jsx)(t6,{});case"admin-profile":return(0,r.jsx)(t7,{});case"admin-users":return(0,r.jsx)(sn,{});case"admin-content":return(0,r.jsx)(si,{});case"admin-reports":return(0,r.jsx)(sc,{});case"notifications":return(0,r.jsx)(su,{});case"ai-chat":return(0,r.jsx)(sp,{})}};return t?(0,r.jsx)(r.Fragment,{children:s()}):(0,r.jsxs)("div",{className:"flex min-h-screen flex-col bg-background",children:[(0,r.jsx)(sv,{}),(0,r.jsx)("main",{className:"flex-1 pb-24",children:s()}),(0,r.jsx)(sC,{})]})}function s_(){return(0,r.jsx)(eh,{children:(0,r.jsx)(s$,{})})}},9416:(e,t,s)=>{Promise.resolve().then(s.bind(s,7124))}},e=>{e.O(0,[512,441,794,358],()=>e(e.s=9416)),_N_E=e.O()}]);